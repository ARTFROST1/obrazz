---
name: Obrazz Expert
description: Ð“Ð»ÑƒÐ±Ð¾ÐºÐ¾Ðµ Ð·Ð½Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð´Ð¾Ð²Ð¾Ð¹ Ð±Ð°Ð·Ñ‹ Obrazz â€” React Native + Expo Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð³Ð°Ñ€Ð´ÐµÑ€Ð¾Ð±Ð¾Ð¼ Ñ AI-ÑÑ‚Ð¸Ð»Ð¸ÑÑ‚Ð¾Ð¼ + Rails backend (API, Ð°Ð´Ð¼Ð¸Ð½ÐºÐ°, Ð±Ð¸Ð»Ð»Ð¸Ð½Ð³). Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹ Ð´Ð»Ñ Ð»ÑŽÐ±Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ.
---

# Obrazz Expert Skill

ÐžÐ±Ñ€Ð°Ð· â€” Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð³Ð°Ñ€Ð´ÐµÑ€Ð¾Ð±Ð° Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑÐ¼Ð¸ AI-ÑÑ‚Ð¸Ð»Ð¸ÑÑ‚Ð°. Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ React Native Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ (Expo SDK 55) Ð¸ Rails 8 backend Ð´Ð»Ñ API, Ð»Ð¸Ñ‡Ð½Ð¾Ð³Ð¾ ÐºÐ°Ð±Ð¸Ð½ÐµÑ‚Ð° Ð¸ Ð°Ð´Ð¼Ð¸Ð½ÐºÐ¸.

## When to Use This Skill

- Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð½Ð¾Ð²Ñ‹Ñ… Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð² Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ð¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¸
- Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð³Ð¾Ð² Ð² React Native/Rails ÐºÐ¾Ð´Ðµ
- Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ API endpoints Ð² Rails backend
- Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð»Ð°Ñ‚ÐµÐ¶ÐµÐ¹ (YooKassa, IAP)
- Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ AI-Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸ÑÐ¼Ð¸ (The New Black API)
- Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾ÐºÐµÐ½Ð°Ð¼Ð¸ Ð¸ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ°Ð¼Ð¸
- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° offline-first ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Zustand stores Ð¸ persistence

## Quick Reference Resources

### Architecture

ðŸ“ **[resources/architecture.md](resources/architecture.md)** â€” ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ ÐºÐ¾Ð´Ð°, ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð², Zustand stores

### Database

ðŸ“ **[resources/database.md](resources/database.md)** â€” ÐŸÐ¾Ð»Ð½Ð°Ñ ÑÑ…ÐµÐ¼Ð° Ð‘Ð”, enums, relationships

### Routes

ðŸ“ **[resources/routes.md](resources/routes.md)** â€” Ð’ÑÐµ API endpoints, Dashboard, Admin routes

### AI & Tokens

ðŸ“ **[resources/ai_tokens.md](resources/ai_tokens.md)** â€” AI Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸, Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°, Ð±Ð¸Ð»Ð»Ð¸Ð½Ð³

## Key Constants

```typescript
// React Native Categories (8 unified)
const CATEGORIES = [
  'tops',
  'bottoms',
  'dresses',
  'outerwear',
  'shoes',
  'bags',
  'accessories',
  'other',
];

// Canvas transforms
const MIN_SCALE = 0.5;
const MAX_SCALE = 3.0;
```

```ruby
# Rails - Subscription Plans
PLANS = %w[free pro_monthly pro_yearly]
PLAN_TOKENS = { "free" => 0, "pro_monthly" => 100, "pro_yearly" => 100 }

# AI Generation Types
GENERATION_TYPES = %w[virtual_try_on fashion_model variation]
TOKEN_COSTS = { "virtual_try_on" => 1, "fashion_model" => 1, "variation" => 1 }
```

## Common Tasks

### Add new screen (React Native)

1. Create file in `app/` directory (Expo Router)
2. Add types in `types/models/` if needed
3. Create components in `components/`
4. Add store actions if needed

### Add new API endpoint (Rails)

1. Add route in `config/routes.rb`
2. Create controller in `app/controllers/api/v1/`
3. Inherit from `Api::V1::BaseController`
4. Use `render_success()` / `render_error()`

### Add Zustand store

```typescript
// store/feature/featureStore.ts
export const useFeatureStore = create<State>()(
  persist(
    (set) => ({
      data: [],
      fetch: async () => {
        /* ... */
      },
    }),
    { name: 'feature-store', storage: zustandStorage },
  ),
);
```

## File Locations

| Purpose           | Location                        |
| ----------------- | ------------------------------- |
| Screens           | `obrazz/app/`                   |
| Components        | `obrazz/components/`            |
| Services          | `obrazz/services/`              |
| Stores            | `obrazz/store/`                 |
| Types             | `obrazz/types/`                 |
| Rails Controllers | `obrazz-rails/app/controllers/` |
| Rails Models      | `obrazz-rails/app/models/`      |
| Rails Services    | `obrazz-rails/app/services/`    |
| Documentation     | `obrazz/Docs/`                  |

## Environment Variables

### React Native

```
EXPO_PUBLIC_SUPABASE_URL=
EXPO_PUBLIC_SUPABASE_ANON_KEY=
EXPO_PUBLIC_PIXIAN_API_ID=
EXPO_PUBLIC_PIXIAN_API_SECRET=
EXPO_PUBLIC_RAILS_API_URL=
```

### Rails

```
DATABASE_URL=
SUPABASE_URL=
SUPABASE_KEY=
SUPABASE_JWT_SECRET=
THE_NEW_BLACK_API_KEY=
YOOKASSA_SHOP_ID=
YOOKASSA_SECRET_KEY=
```

## Testing Commands

```bash
# React Native
npm test                    # Jest tests
npm run type-check          # TypeScript check

# Rails
bundle exec rspec           # RSpec tests
bin/rubocop                 # RuboCop linting
bin/brakeman --no-pager     # Security scan
```

## Development Commands

```bash
# React Native
npm start                   # Expo dev server
npm run ios                 # iOS simulator
npm run android             # Android emulator
npm run lint:fix            # Fix ESLint

# Rails
bin/dev                     # Start all processes
bin/rails console           # Rails console
bin/rails db:migrate        # Run migrations
```

## Debugging Tips

- **Auth issues:** Check `authStore.ts` + `supabase/client.ts` SafeStorage
- **Outfit not saving:** Verify `canvasSettings` in `outfitService.createOutfit()`
- **Custom tabs not loading:** Check `itemSelectionStepNew.tsx` AsyncStorage conditional
- **Gestures not working:** Ensure `react-native-gesture-handler` imported at root
- **Rails JWT errors:** Check `SUPABASE_JWT_SECRET` env var
- **Payment webhooks:** Check `webhook_events` table for errors
