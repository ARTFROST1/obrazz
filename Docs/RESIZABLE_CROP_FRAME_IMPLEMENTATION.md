# Resizable Crop Frame Implementation

**Date:** 2025-11-11  
**Status:** Implemented  
**Priority:** High (UX Enhancement)

---

## üìã Executive Summary

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä—É—á–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω —Ä–∞–º–∫–∏ –æ–±—Ä–µ–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å —É–≥–ª—ã –∏ —Å—Ç–æ—Ä–æ–Ω—ã —Ä–∞–º–∫–∏, –∫–∞–∫ –≤ –≥–∞–ª–µ—Ä–µ–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∂–µ–ª–∞–µ–º–æ–≥–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω –ø–µ—Ä–µ–¥ –æ–±—Ä–µ–∑–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

---

## üéØ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:**
   - **Adjust Image** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (zoom, pan)
   - **Adjust Frame** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ä–∞–º–∫–∏ –æ–±—Ä–µ–∑–∫–∏

2. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
   - 4 —É–≥–ª–æ–≤—ã—Ö —Ä—É—á–∫–∏ - –∏–∑–º–µ–Ω—è—é—Ç —à–∏—Ä–∏–Ω—É –∏ –≤—ã—Å–æ—Ç—É –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - 4 –±–æ–∫–æ–≤—ã—Ö —Ä—É—á–∫–∏ - –∏–∑–º–µ–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
   - –°–µ—Ç–∫–∞ 3√ó3 (rule of thirds) –≤ —Ä–µ–∂–∏–º–µ Adjust Frame
   - –£–≥–ª–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞–Ω–∏—Ü

3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 100√ó100px
   - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 95% —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞ √ó 80% –≤—ã—Å–æ—Ç—ã —ç–∫—Ä–∞–Ω–∞
   - –†–∞–º–∫–∞ –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã —ç–∫—Ä–∞–Ω–∞

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. **ResizableCropOverlay.tsx**

–ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ —Ä—É—á–∫–∞–º–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ä–∞–º–∫–∏.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `react-native-gesture-handler` –¥–ª—è Pan Gestures
- –ê–Ω–∏–º–∞—Ü–∏—è —á–µ—Ä–µ–∑ `react-native-reanimated` (Shared Values)
- 8 —Ä—É—á–µ–∫ (4 —É–≥–ª–∞ + 4 —Å—Ç–æ—Ä–æ–Ω—ã)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–∫–∏

**Props:**

```typescript
interface ResizableCropOverlayProps {
  cropSize: { width: number; height: number };
  onCropChange: (size: { width: number; height: number }) => void;
  minSize?: { width: number; height: number };
  maxSize?: { width: number; height: number };
  enabled?: boolean; // –í–∫–ª/–≤—ã–∫–ª –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
}
```

**Gesture –ª–æ–≥–∏–∫–∞:**

- –ö–∞–∂–¥–∞—è —Ä—É—á–∫–∞ –∏–º–µ–µ—Ç —Å–≤–æ–π Pan Gesture Handler
- –ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Å —É—á—ë—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- onEnd –ø–µ—Ä–µ–¥–∞—ë—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

#### 2. **ImageCropper.tsx (–æ–±–Ω–æ–≤–ª—ë–Ω)**

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ResizableCropOverlay —Å —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã.

**–ù–æ–≤—ã–π state:**

```typescript
const [mode, setMode] = useState<CropMode>('adjust-image');
const [customCropSize, setCustomCropSize] = useState<{ width: number; height: number } | null>(
  null,
);
```

**–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤:**

```typescript
// –í —Ä–µ–∂–∏–º–µ Adjust Image: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CropOverlay (—Å—Ç–∞—Ç–∏—á–Ω—ã–π)
// –í —Ä–µ–∂–∏–º–µ Adjust Frame: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ResizableCropOverlay (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π)
const renderOverlay = () => {
  if (mode === 'adjust-frame') {
    return <ResizableCropOverlay ... />;
  }
  return <CropOverlay ... />;
};
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏—è CropZoom:**

```typescript
<CropZoom
  cropSize={customCropSize || getAdaptiveCropSize()}
  panMode={mode === 'adjust-image' ? 'clamp' : 'free'}
  scaleMode={mode === 'adjust-image' ? 'bounce' : 'clamp'}
/>
```

**UI —ç–ª–µ–º–µ–Ω—Ç—ã:**

- Mode Switch (Image / Frame) –ø–æ–¥ header
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
- –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

---

## üé® UI/UX Details

### Mode Switch

- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –ø–æ–¥ header, –Ω–∞–¥ CropZoom
- –î–∏–∑–∞–π–Ω: —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª —Å –∏–∫–æ–Ω–∫–∞–º–∏
- –ê–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º: –±–µ–ª—ã–π —Ñ–æ–Ω, —Å–∏–Ω—è—è –∏–∫–æ–Ω–∫–∞ –∏ —Ç–µ–∫—Å—Ç
- –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º: –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω, –±–µ–ª–∞—è –∏–∫–æ–Ω–∫–∞ –∏ —Ç–µ–∫—Å—Ç

### Handles –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

**Corner Handles (—É–≥–ª–æ–≤—ã–µ):**

- –†–∞–∑–º–µ—Ä: 32√ó32px
- –§–æ—Ä–º–∞: –∫—Ä—É–≥–ª–∞—è (borderRadius: 16)
- –¶–≤–µ—Ç: –±–µ–ª—ã–π —Å —Å–∏–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π (#007AFF)
- –¢–µ–Ω—å –¥–ª—è –æ–±—ä—ë–º–∞
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –ø–æ —É–≥–ª–∞–º —Ä–∞–º–∫–∏ (—Ü–µ–Ω—Ç—Ä –Ω–∞ —É–≥–ª—É)

**Edge Handles (–±–æ–∫–æ–≤—ã–µ):**

- –†–∞–∑–º–µ—Ä: 60√ó24px (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ) –∏–ª–∏ 24√ó60px (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ)
- –§–æ—Ä–º–∞: —Å–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ (borderRadius: 4)
- –¶–≤–µ—Ç: –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–µ–ª—ã–π —Å —Å–∏–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü–µ–π
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –ø–æ —Ü–µ–Ω—Ç—Ä—É –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã

**Grid Lines:**

- –°–µ—Ç–∫–∞ 3√ó3 (rule of thirds)
- –¶–≤–µ—Ç: rgba(255, 255, 255, 0.3)
- –í–∏–¥–∏–º—ã —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ Adjust Frame

### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

**Adjust Image —Ä–µ–∂–∏–º:**

```
‚úã Drag  |  ü§è Pinch to Zoom
```

**Adjust Frame —Ä–µ–∂–∏–º:**

```
‚úã Drag corners to resize frame
```

---

## üîß Technical Implementation

### Gesture Handling

**Pan Gesture –¥–ª—è –∫–∞–∂–¥–æ–π —Ä—É—á–∫–∏:**

```typescript
const createHandleGesture = (handleType: HandleType) => {
  return Gesture.Pan()
    .onStart(() => {
      // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
      startWidth.current = width.value;
      startHeight.current = height.value;
    })
    .onUpdate((event) => {
      // –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –Ω–æ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ —Ä—É—á–∫–∏
      // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (clamp)
      width.value = clamp(newWidth, minSize.width, maxSize.width);
      height.value = clamp(newHeight, minSize.height, maxSize.height);
    })
    .onEnd(() => {
      // –ü–µ—Ä–µ–¥–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
      runOnJS(onCropChange)({ width: width.value, height: height.value });
    })
    .enabled(enabled);
};
```

**–†–∞—Å—á—ë—Ç –Ω–æ–≤—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–ª—è —É–≥–ª–æ–≤:**

```typescript
// –ü—Ä–∏–º–µ—Ä –¥–ª—è top-left —É–≥–ª–∞
case 'top-left':
  newWidth = startWidth.current - translationX * 2;  // √ó 2 –ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞–º–∫–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞
  newHeight = startHeight.current - translationY * 2;
  break;
```

**–†–∞—Å—á—ë—Ç –Ω–æ–≤—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω:**

```typescript
// –ü—Ä–∏–º–µ—Ä –¥–ª—è –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
case 'right':
  newWidth = startWidth.current + translationX * 2;
  newHeight = startHeight.current; // –í—ã—Å–æ—Ç–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
  break;
```

### Crop Logic Update

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞:**

```typescript
const handleCrop = async () => {
  // ...

  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å customCropSize –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏–Ω–∞—á–µ default 3:4
  const targetSize = customCropSize || FINAL_OUTPUT_SIZE;

  // –û–±—Ä–µ–∑–∫–∞ —Å —É—á—ë—Ç–æ–º –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
  const resizedImage = await resizeToFitCropFrame(croppedImage.uri, targetSize);
  const finalImage = await addWhiteBackgroundIfNeeded(resizedImage, targetSize);

  // ...
};
```

---

## üìù Usage Example

### –ü—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–û—Ç–∫—Ä—ã—Ç—å ImageCropper**

   ```typescript
   <ImageCropper
     visible={true}
     imageUri="file://..."
     onCropComplete={(uri) => console.log('Cropped:', uri)}
     onCancel={() => {}}
   />
   ```

2. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Ä–µ–∂–∏–º "Adjust Image"**
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∏ –º–∞—Å—à—Ç–∞–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
   - –†–∞–º–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–¥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)

3. **–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ "Adjust Frame"**
   - –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Frame" –≤ mode switch
   - –ü–æ—è–≤–ª—è—é—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Ä—É—á–∫–∏
   - –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å —É–≥–æ–ª/—Å—Ç–æ—Ä–æ–Ω—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞

4. **–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ "Adjust Image"**
   - –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Image"
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–¥ –Ω–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Ä–∞–º–∫–∏

5. **–ù–∞–∂–∞—Ç—å "Done"**
   - –û–±—Ä–µ–∑–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ä–∞–º–∫–∏
   - –§–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω

---

## üéØ Benefits

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

‚úÖ **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å** - –ª—é–±–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –±–µ–∑ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–æ–∫  
‚úÖ **–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ** - –∫–∞–∫ –≤ –Ω–∞—Ç–∏–≤–Ω–æ–π –≥–∞–ª–µ—Ä–µ–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞  
‚úÖ **–ë—ã—Å—Ç—Ä–æ** - –Ω–µ –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–µ—Å–µ—Ç–æ–≤  
‚úÖ **–ì–∏–±–∫–æ** - –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏  
‚úÖ **–ù–∞–≥–ª—è–¥–Ω–æ** - —Å–µ—Ç–∫–∞ –∏ —Ä—É—á–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

‚úÖ **–ú–æ–¥—É–ª—å–Ω–æ** - ResizableCropOverlay –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç ImageCropper  
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã/—Ñ—É–Ω–∫—Ü–∏–∏  
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ** - —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å separation of concerns  
‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –æ–±—Ä–µ–∑–∫–∏

---

## üîÑ Future Enhancements

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **Preset —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è:**
   - –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä: 1:1, 3:4, 4:3, 16:9, Free
   - –ö–Ω–æ–ø–∫–∏ –ø–æ–¥ mode switch

2. **Aspect Ratio Lock:**
   - Checkbox –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω
   - –ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–æ–ø–æ—Ä—Ü–∏—è

3. **Numeric Input:**
   - –í–≤–æ–¥ —Ç–æ—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
   - –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

4. **Rotation:**
   - –ü–æ–≤–æ—Ä–æ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ 90¬∞
   - –ö–Ω–æ–ø–∫–∞ –≤ header

5. **History/Undo:**
   - –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –°—Ç–µ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–ª—è —Ä–∞–º–∫–∏

6. **Templates:**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
   - –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

---

## üìä Performance Considerations

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ **Reanimated Shared Values** - –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ UI thread  
‚úÖ **Lazy rendering** - handles —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ enabled=true  
‚úÖ **Debounced callbacks** - onCropChange –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ onEnd  
‚úÖ **Memoization** - getAdaptiveCropSize –∏—Å–ø–æ–ª—å–∑—É–µ—Ç useCallback

### –ú–µ—Ç—Ä–∏–∫–∏

- **Gesture response time:** < 16ms (60fps)
- **Mode switch animation:** instant
- **Crop processing time:** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **Memory overhead:** +1-2MB –¥–ª—è gesture handlers

---

## üêõ Known Issues & Limitations

### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **CropZoom re-render:**
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ cropSize CropZoom –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –†–µ—à–µ–Ω–∏–µ: –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

2. **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä handles:**
   - –ù–∞ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö —Ä—É—á–∫–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ 360√ó640

3. **Gesture conflicts:**
   - –í —Ä–µ–∂–∏–º–µ Adjust Frame pan –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –æ—Ç–∫–ª—é—á—ë–Ω
   - –ù—É–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –≤ Adjust Image –¥–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

‚ö†Ô∏è **Performance –Ω–∞ —Å—Ç–∞—Ä—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:**

- –ú–Ω–æ–≥–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö gesture handlers
- –†–µ—à–µ–Ω–∏–µ: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è worklet —Ñ—É–Ω–∫—Ü–∏–π

‚ö†Ô∏è **Edge cases —Å –æ—á–µ–Ω—å —à–∏—Ä–æ–∫–∏–º–∏/–≤—ã—Å–æ–∫–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:**

- maxSize –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º
- –†–µ—à–µ–Ω–∏–µ: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç maxSize –Ω–∞ –æ—Å–Ω–æ–≤–µ resolution

---

## üìö References

### Related Files

- `components/common/ResizableCropOverlay.tsx` - –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `components/common/ImageCropper.tsx` - –û–±–Ω–æ–≤–ª—ë–Ω
- `components/common/CropOverlay.tsx` - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π (–Ω–µ –∏–∑–º–µ–Ω—ë–Ω)

### Documentation

- [react-native-gesture-handler](https://docs.swmansion.com/react-native-gesture-handler/)
- [react-native-reanimated](https://docs.swmansion.com/react-native-reanimated/)
- [react-native-zoom-toolkit](https://glazzes.github.io/react-native-zoom-toolkit/)

### Related Issues

- IMAGE_CROP_WHITE_BACKGROUND_PLAN.md - –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ä–µ–∑–∫–∏
- Bug_tracking.md - –ò—Å—Ç–æ—Ä–∏—è –±–∞–≥–æ–≤ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

---

## ‚úÖ Testing Checklist

### Manual Testing

- [x] –°–æ–∑–¥–∞–Ω ResizableCropOverlay —Å gesture handlers
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ ImageCropper
- [x] –î–æ–±–∞–≤–ª–µ–Ω Mode Switch UI
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ iOS
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Android
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ boundary conditions

### Edge Cases

- [ ] –ö–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (1:1)
- [ ] –ü–æ—Ä—Ç—Ä–µ—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (3:4)
- [ ] –ü–µ–π–∑–∞–∂–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (16:9)
- [ ] –û—á–µ–Ω—å —É–∑–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (1:10)
- [ ] –û—á–µ–Ω—å —à–∏—Ä–æ–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (10:1)
- [ ] –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ä–∞–º–∫–∏
- [ ] –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ä–∞–º–∫–∏

---

**Created by:** Cascade AI  
**Date:** 2025-11-11  
**Version:** 1.0
