# ğŸ—ï¸ ĞŸĞ»Ğ°Ğ½ Ñ€ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ Obrazz

> **Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 30 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026  
> **Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0.0  
> **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ  
> **ĞĞ²Ñ‚Ğ¾Ñ€:** AI Architect

---

## ğŸ“‹ ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

1. [Ğ ĞµĞ·ÑĞ¼Ğµ](#Ñ€ĞµĞ·ÑĞ¼Ğµ)
2. [Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ](#Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ-ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ)
3. [Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°](#Ñ†ĞµĞ»ĞµĞ²Ğ°Ñ-Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)
4. [ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸](#ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹-Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸)
5. [ĞŸĞ»Ğ°Ğ½ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ ÑÑ‚Ğ°Ğ¿Ğ°Ğ¼](#Ğ¿Ğ»Ğ°Ğ½-Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸-Ğ¿Ğ¾-ÑÑ‚Ğ°Ğ¿Ğ°Ğ¼)
6. [Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Node.js Backend](#Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ-ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ-nodejs-backend)
7. [Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Frontend Dashboard](#Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ-ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ-frontend-dashboard)
8. [Free Tier Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ Ğ¸ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ](#free-tier-Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹-Ğ¸-Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ)
9. [Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Ğ¼Ğ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ](#Ñ€Ğ¸ÑĞºĞ¸-Ğ¸-Ğ¼Ğ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ)
10. [ĞÑ†ĞµĞ½ĞºĞ° Ñ‚Ñ€ÑƒĞ´Ğ¾Ğ·Ğ°Ñ‚Ñ€Ğ°Ñ‚](#Ğ¾Ñ†ĞµĞ½ĞºĞ°-Ñ‚Ñ€ÑƒĞ´Ğ¾Ğ·Ğ°Ñ‚Ñ€Ğ°Ñ‚)

---

## ğŸ“ Ğ ĞµĞ·ÑĞ¼Ğµ

### Ğ¦ĞµĞ»ÑŒ Ñ€ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

Ğ Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ½Ğ¾Ğ»Ğ¸Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Rails backend Ğ½Ğ°:

1. **Lightweight Node.js API** (Render) â€” Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°, AI, Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ¸
2. **Next.js Frontend** (Vercel) â€” Ğ»ĞµĞ½Ğ´Ğ¸Ğ½Ğ³ + Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ±Ğ¸Ğ½ĞµÑ‚
3. **Rails Admin** (Render, Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚) â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ°Ğ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ

### ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

| Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ               | Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ                                    |
| ------------------------ | ------------------------------------------ |
| Free Tier Ğ²ĞµĞ·Ğ´Ğµ          | Render Free + Vercel Hobby + Supabase Free |
| AI Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ñ FASHN SDK   | Node.js backend Ñ TypeScript SDK           |
| ĞšĞ¾Ğ½ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ñ‹Ğ¹ UI         | ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ ERB â†’ React ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹            |
| Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº frontend     | TypeScript Ğ²ĞµĞ·Ğ´Ğµ                           |
| Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ½Ğ° backend | ĞĞ• Ğ² Supabase Edge Functions               |

---

## ğŸ“Š Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° AS-IS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        VERCEL (Hobby)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Next.js Landing Page                                            â”‚â”‚
â”‚  â”‚  - ĞœĞ°Ñ€ĞºĞµÑ‚Ğ¸Ğ½Ğ³Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°                                        â”‚â”‚
â”‚  â”‚  - Ğ¡Ñ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚                                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RENDER (Free Tier)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Ruby on Rails 8.0.4 (ĞœĞĞĞĞ›Ğ˜Ğ¢)                                   â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ API Ğ´Ğ»Ñ Mobile App (/api/v1/*)                              â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Ğ›Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ±Ğ¸Ğ½ĞµÑ‚ (Dashboard) - Rails Views + Hotwire          â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Admin Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (/admin/*)                                     â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° (Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸, Ñ‚Ğ¾ĞºĞµĞ½Ñ‹, Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ¸)                   â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ AI Proxy (The New Black API)                                â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Background Jobs (Solid Queue)                               â”‚â”‚
â”‚  â”‚  â””â”€â”€ Webhooks (YooKassa, Apple, Google)                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SUPABASE (Free Tier)                          â”‚
â”‚  â”œâ”€â”€ Auth (JWT, OAuth)                                               â”‚
â”‚  â”œâ”€â”€ PostgreSQL Database                                             â”‚
â”‚  â””â”€â”€ Storage (Images)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

| ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°               | Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ                                           |
| ---------------------- | ------------------------------------------------- |
| **Ğ¢ÑĞ¶Ñ‘Ğ»Ñ‹Ğ¹ Rails**      | Cold start 30-60 ÑĞµĞº Ğ½Ğ° Render Free               |
| **Sleep Ğ¿Ğ¾ÑĞ»Ğµ 15 Ğ¼Ğ¸Ğ½** | ĞŸĞ»Ğ¾Ñ…Ğ¾Ğ¹ UX Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°                     |
| **Ruby â‰  FASHN SDK**   | ĞÑƒĞ¶ĞµĞ½ HTTP client Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ TypeScript SDK |
| **Ğ¡Ğ¼ĞµÑˆĞ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´**      | Frontend (ERB) + Backend (Ruby) Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¼ Ğ¼ĞµÑÑ‚Ğµ     |
| **Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´ĞµĞ¿Ğ»Ğ¾Ñ**   | ĞĞ´Ğ¸Ğ½ Ğ¼Ğ¾Ğ½Ğ¾Ğ»Ğ¸Ñ‚ = Ğ²ÑÑ‘ Ğ»Ğ¾Ğ¼Ğ°ĞµÑ‚ÑÑ Ğ²Ğ¼ĞµÑÑ‚Ğµ                |

### Ğ˜Ğ½Ğ²ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Rails ĞºĞ¾Ğ´Ğ°

#### Controllers (Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Node.js)

| Controller                         | Ğ¤Ğ°Ğ¹Ğ»                                  | Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»             | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
| ---------------------------------- | ------------------------------------- | ---------------------- | --------- |
| `Api::V1::AiGenerationsController` | `api/v1/ai_generations_controller.rb` | CRUD Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹, ÑÑ‚Ğ°Ñ‚ÑƒÑ | HIGH      |
| `Api::V1::TokensController`        | `api/v1/tokens_controller.rb`         | Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ, Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ        | HIGH      |
| `Api::V1::SubscriptionsController` | `api/v1/subscriptions_controller.rb`  | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸  | HIGH      |
| `Api::V1::PaymentsController`      | `api/v1/payments_controller.rb`       | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹      | HIGH      |
| `Api::V1::UsersController`         | `api/v1/users_controller.rb`          | ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ   | MEDIUM    |
| `Api::V1::Webhooks::*`             | `api/v1/webhooks/*`                   | ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²ĞµĞ±Ñ…ÑƒĞºĞ¾Ğ²     | HIGH      |
| `Api::V1::Ai::*`                   | `api/v1/ai/*`                         | Shortcuts Ğ´Ğ»Ñ AI       | HIGH      |

#### Services (Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Node.js)

| Service                     | Ğ¤Ğ°Ğ¹Ğ»                                    | LOC  | Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»                      |
| --------------------------- | --------------------------------------- | ---- | ------------------------------- |
| `Ai::GenerationService`     | `services/ai/generation_service.rb`     | ~170 | ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹        |
| `Ai::TheNewBlackClient`     | `services/ai/the_new_black_client.rb`   | ~171 | HTTP ĞºĞ»Ğ¸ĞµĞ½Ñ‚ (Ğ·Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ½Ğ° FASHN) |
| `Tokens::BalanceService`    | `services/tokens/balance_service.rb`    | ~175 | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ°Ğ¼Ğ¸             |
| `Payments::YookassaService` | `services/payments/yookassa_service.rb` | ~100 | YooKassa Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ             |
| `Auth::SupabaseJwtService`  | `services/auth/supabase_jwt_service.rb` | ~80  | JWT Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ                   |
| `Webhooks::*`               | `services/webhooks/*`                   | ~200 | ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²ĞµĞ±Ñ…ÑƒĞºĞ¾Ğ²              |

#### Dashboard Views (Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Next.js)

| View         | Ğ¤Ğ°Ğ¹Ğ»                                                       | Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»             |
| ------------ | ---------------------------------------------------------- | ---------------------- |
| Home         | `views/dashboard/home/index.html.erb`                      | Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ›Ğš (299 ÑÑ‚Ñ€Ğ¾Ğº) |
| Generations  | `views/dashboard/generations/*`                            | Ğ“Ğ°Ğ»ĞµÑ€ĞµÑ AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹   |
| Tokens       | `views/dashboard/tokens/*`                                 | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ°Ğ¼Ğ¸    |
| Subscription | `views/dashboard/subscriptions/*`                          | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¾Ğ¹   |
| Settings     | `views/dashboard/settings/*`                               | ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ      |
| Auth         | `views/dashboard/sessions/*`, `registrations/*`, `oauth/*` | ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ            |

#### Admin Views (Ğ¾ÑÑ‚Ğ°ÑÑ‚ÑÑ Ğ½Ğ° Rails)

| View                   | Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»                |
| ---------------------- | ------------------------- |
| `admin/dashboard`      | Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°                |
| `admin/users`          | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸ |
| `admin/subscriptions`  | Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°Ğ¼Ğ¸     |
| `admin/payments`       | Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹          |
| `admin/ai_generations` | AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸              |

### Database Schema (Supabase)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     users       â”‚â”€â”€â”€â”€<â”‚  subscriptions  â”‚     â”‚   ai_generationsâ”‚
â”‚  (supabase_id)  â”‚     â”‚   (user_id)     â”‚     â”‚   (user_id)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼              â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ token_balances  â”‚ â”‚  payments  â”‚ â”‚   items    â”‚ â”‚    outfits     â”‚
â”‚   (user_id)     â”‚ â”‚ (user_id)  â”‚ â”‚ (user_id)  â”‚ â”‚   (user_id)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚token_transactionsâ”‚
â”‚(token_balance_id)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° TO-BE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           VERCEL (Hobby)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”â”‚
â”‚  â”‚  Next.js 15 App                                                      â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Landing Page (/)                    â† Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚                â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Dashboard (/dashboard/*)            â† ĞĞĞ’ĞĞ• (Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Rails)  â”‚â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ /dashboard                      - Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ                   â”‚â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ /dashboard/generations          - AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸              â”‚â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ /dashboard/tokens               - Ğ¢Ğ¾ĞºĞµĞ½Ñ‹                    â”‚â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ /dashboard/subscription         - ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°                  â”‚â”‚
â”‚  â”‚  â”‚   â””â”€â”€ /dashboard/settings             - ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸                 â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ Auth Pages (/login, /signup)        â† ĞĞĞ’ĞĞ•                     â”‚â”‚
â”‚  â”‚  â””â”€â”€ API Routes (/api/*)                 - Proxy to Node.js backend  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚ HTTPS
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RENDER #1 (Free Tier)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”â”‚
â”‚  â”‚  Node.js Backend (Hono/Fastify)                                      â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v1/ai/*              - AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ (FASHN SDK)            â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v1/tokens/*          - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ°Ğ¼Ğ¸                 â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v1/subscriptions/*   - ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸                            â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v1/payments/*        - ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ¸ (YooKassa)                  â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v1/users/*           - ĞŸÑ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ                             â”‚â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v1/webhooks/*        - Webhook handlers                    â”‚â”‚
â”‚  â”‚  â””â”€â”€ Background Jobs           - BullMQ + Redis (Ğ¸Ğ»Ğ¸ Ğ±ĞµĞ·)            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        RENDER #2 (Free Tier, Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”â”‚
â”‚  â”‚  Ruby on Rails 8 (Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Admin)                                      â”‚â”‚
â”‚  â”‚  â””â”€â”€ /admin/*                  - ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SUPABASE (Free Tier)                              â”‚
â”‚  â”œâ”€â”€ Auth (JWT, OAuth providers)                                         â”‚
â”‚  â”œâ”€â”€ PostgreSQL Database (Ğ²ÑĞµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹)                                   â”‚
â”‚  â””â”€â”€ Storage (Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FASHN AI (External API)                           â”‚
â”‚  â”œâ”€â”€ Virtual Try-On v1.6                                                 â”‚
â”‚  â”œâ”€â”€ Product to Model                                                    â”‚
â”‚  â”œâ”€â”€ Face to Model                                                       â”‚
â”‚  â””â”€â”€ Clothing Variations                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

#### 1. AI Generation Flow

```
Mobile App / Dashboard
        â”‚
        â–¼ POST /api/v1/ai/virtual-try-on
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel (Proxy)   â”‚  â† ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node.js Backend   â”‚
â”‚ (Render)          â”‚
â”‚  1. Validate JWT  â”‚
â”‚  2. Check tokens  â”‚
â”‚  3. Call FASHN    â”‚
â”‚  4. Deduct tokens â”‚
â”‚  5. Save result   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚FASHN  â”‚  â”‚Supabaseâ”‚
â”‚ AI    â”‚  â”‚ DB/   â”‚
â”‚       â”‚  â”‚Storageâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. Payment Flow (YooKassa)

```
Dashboard (Vercel)
        â”‚
        â–¼ POST /api/payments
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node.js Backend   â”‚
â”‚  1. Create paymentâ”‚
â”‚  2. Get redirect  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    YooKassa       â”‚
â”‚  (checkout page)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ webhook
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node.js Backend   â”‚
â”‚  POST /webhooks/  â”‚
â”‚  yookassa         â”‚
â”‚  1. Verify sig    â”‚
â”‚  2. Update paymentâ”‚
â”‚  3. Credit tokens â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ 1: Node.js Backend

#### Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€ĞºĞ°

| Ğ¤Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€Ğº   | Boot time | Memory | ĞŸĞ»ÑÑÑ‹                             | ĞœĞ¸Ğ½ÑƒÑÑ‹             |
| ----------- | --------- | ------ | --------------------------------- | ------------------ |
| **Hono** â­ | ~100ms    | ~50MB  | Ğ£Ğ»ÑŒÑ‚Ñ€Ğ°Ğ»Ñ‘Ğ³ĞºĞ¸Ğ¹, Edge-ready          | ĞœĞµĞ½ÑŒÑˆĞµ middleware  |
| Fastify     | ~200ms    | ~80MB  | Production-ready, ÑÑ…ĞµĞ¼Ğ° Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸ | Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ boilerplate |
| Express     | ~300ms    | ~100MB | ĞĞ³Ñ€Ğ¾Ğ¼Ğ½Ğ°Ñ ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°               | ĞœĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ          |

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ:** Hono â€” Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ footprint, Ğ¸Ğ´ĞµĞ°Ğ»ĞµĞ½ Ğ´Ğ»Ñ Free Tier.

#### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° Node.js

```
obrazz-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                    # Entry point
â”‚   â”œâ”€â”€ app.ts                      # Hono app setup
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.ts                 # JWT validation (Supabase)
â”‚   â”‚   â”œâ”€â”€ cors.ts                 # CORS config
â”‚   â”‚   â””â”€â”€ error-handler.ts        # Global error handling
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ ai.routes.ts            # AI generation endpoints
â”‚   â”‚   â”œâ”€â”€ tokens.routes.ts        # Token management
â”‚   â”‚   â”œâ”€â”€ subscriptions.routes.ts # Subscription management
â”‚   â”‚   â”œâ”€â”€ payments.routes.ts      # Payment endpoints
â”‚   â”‚   â”œâ”€â”€ users.routes.ts         # User profile
â”‚   â”‚   â””â”€â”€ webhooks.routes.ts      # Webhook handlers
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”‚   â”œâ”€â”€ fashn.service.ts    # FASHN AI SDK wrapper
â”‚   â”‚   â”‚   â””â”€â”€ generation.service.ts
â”‚   â”‚   â”œâ”€â”€ tokens/
â”‚   â”‚   â”‚   â””â”€â”€ balance.service.ts
â”‚   â”‚   â”œâ”€â”€ payments/
â”‚   â”‚   â”‚   â””â”€â”€ yookassa.service.ts
â”‚   â”‚   â””â”€â”€ auth/
â”‚   â”‚       â””â”€â”€ supabase.service.ts
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ client.ts               # Supabase client
â”‚   â”‚   â””â”€â”€ queries/                # SQL queries
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ env.ts
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ Dockerfile
â””â”€â”€ render.yaml
```

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ 2: Next.js Dashboard

#### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ² ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ¼ Ğ»ĞµĞ½Ğ´Ğ¸Ğ½Ğ³Ğµ

```
obrazz-landing/                      # Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx                     # Landing (ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚)
â”‚   â”œâ”€â”€ layout.tsx                   # Root layout
â”‚   â”œâ”€â”€ (auth)/                      # Auth group
â”‚   â”‚   â”œâ”€â”€ login/page.tsx           # Ğ›Ğ¾Ğ³Ğ¸Ğ½
â”‚   â”‚   â”œâ”€â”€ signup/page.tsx          # Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â””â”€â”€ layout.tsx               # Auth layout
â”‚   â”œâ”€â”€ (dashboard)/                 # Dashboard group
â”‚   â”‚   â”œâ”€â”€ layout.tsx               # Dashboard layout (sidebar)
â”‚   â”‚   â”œâ”€â”€ page.tsx                 # /dashboard - Ğ³Ğ»Ğ°Ğ²Ğ½Ğ°Ñ
â”‚   â”‚   â”œâ”€â”€ generations/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx             # Ğ“Ğ°Ğ»ĞµÑ€ĞµÑ
â”‚   â”‚   â”‚   â””â”€â”€ [id]/page.tsx        # Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”‚   â”œâ”€â”€ tokens/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx             # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾ĞºĞµĞ½Ğ°Ğ¼Ğ¸
â”‚   â”‚   â”œâ”€â”€ subscription/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx             # Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¾Ğ¹
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚       â””â”€â”€ page.tsx             # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
â”‚   â””â”€â”€ api/                         # API Routes (proxy)
â”‚       â””â”€â”€ v1/
â”‚           â””â”€â”€ [...path]/route.ts   # Proxy to Node.js
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ landing/                     # Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”œâ”€â”€ dashboard/                   # ĞĞĞ’Ğ«Ğ• ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”œâ”€â”€ StatsCard.tsx
â”‚   â”‚   â”œâ”€â”€ GenerationCard.tsx
â”‚   â”‚   â”œâ”€â”€ TokenBalance.tsx
â”‚   â”‚   â””â”€â”€ SubscriptionStatus.tsx
â”‚   â””â”€â”€ ui/                          # ĞĞ±Ñ‰Ğ¸Ğµ UI ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts                # Browser client
â”‚   â”‚   â””â”€â”€ server.ts                # Server client
â”‚   â””â”€â”€ api.ts                       # API client
â””â”€â”€ ...
```

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ 3: Rails Admin (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹)

#### Ğ§Ñ‚Ğ¾ Ğ¾ÑÑ‚Ğ°Ñ‘Ñ‚ÑÑ

```
obrazz-admin/                        # Ğ£Ñ€ĞµĞ·Ğ°Ğ½Ğ½Ñ‹Ğ¹ Rails
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â””â”€â”€ admin/                   # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ admin ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”œâ”€â”€ admin/                   # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ admin views
â”‚   â”‚   â””â”€â”€ layouts/admin.html.erb
â”‚   â””â”€â”€ models/                      # Read-only Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Supabase
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ routes.rb                    # Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ /admin/* routes
â”‚   â””â”€â”€ database.yml                 # Supabase connection
â””â”€â”€ Gemfile                          # ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ½Ğ°Ğ±Ğ¾Ñ€ gems
```

---

## ğŸ“… ĞŸĞ»Ğ°Ğ½ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ ÑÑ‚Ğ°Ğ¿Ğ°Ğ¼

### Ğ­Ñ‚Ğ°Ğ¿ 0: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° (1 Ğ´ĞµĞ½ÑŒ)

- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ `obrazz-api` Ğ´Ğ»Ñ Node.js backend
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ TypeScript, ESLint, Prettier
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ°Ğ·Ğ¾Ğ²ÑƒÑ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ Hono Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Supabase client
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ½Ğ° Render (Docker)

### Ğ­Ñ‚Ğ°Ğ¿ 1: Core API (3-4 Ğ´Ğ½Ñ)

#### 1.1 Auth Middleware

```typescript
// src/middleware/auth.ts
import { createMiddleware } from 'hono/factory';
import { createClient } from '@supabase/supabase-js';
import { verify } from 'jsonwebtoken';

export const authMiddleware = createMiddleware(async (c, next) => {
  const authHeader = c.req.header('Authorization');
  if (!authHeader?.startsWith('Bearer ')) {
    return c.json({ error: 'Unauthorized' }, 401);
  }

  const token = authHeader.substring(7);

  try {
    const payload = verify(token, process.env.SUPABASE_JWT_SECRET!);
    const supabaseId = (payload as any).sub;

    // Get or create user
    const supabase = createClient(process.env.SUPABASE_URL!, process.env.SUPABASE_SERVICE_KEY!);

    let { data: user } = await supabase
      .from('users')
      .select('*')
      .eq('supabase_id', supabaseId)
      .single();

    if (!user) {
      const { data: newUser } = await supabase
        .from('users')
        .insert({
          supabase_id: supabaseId,
          email: (payload as any).email,
          status: 'active',
        })
        .select()
        .single();
      user = newUser;
    }

    c.set('user', user);
    c.set('supabase', supabase);

    await next();
  } catch (error) {
    return c.json({ error: 'Invalid token' }, 401);
  }
});
```

#### 1.2 Tokens Service

```typescript
// src/services/tokens/balance.service.ts
import { SupabaseClient } from '@supabase/supabase-js';

interface User {
  id: string;
  supabase_id: string;
}

export class TokenBalanceService {
  constructor(
    private supabase: SupabaseClient,
    private user: User,
  ) {}

  async getAvailableBalance(): Promise<number> {
    const { data } = await this.supabase
      .from('token_balances')
      .select('balance')
      .eq('user_id', this.user.id)
      .gt('balance', 0);

    return data?.reduce((sum, b) => sum + b.balance, 0) ?? 0;
  }

  async debitForGeneration(amount: number, generationId: string): Promise<void> {
    // ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ: subscription -> purchased -> bonus
    const tokenTypes = ['subscription_tokens', 'purchased_tokens', 'bonus_tokens'];
    let remaining = amount;

    for (const tokenType of tokenTypes) {
      if (remaining <= 0) break;

      const { data: balance } = await this.supabase
        .from('token_balances')
        .select('*')
        .eq('user_id', this.user.id)
        .eq('token_type', tokenType)
        .gt('balance', 0)
        .single();

      if (balance) {
        const deductAmount = Math.min(remaining, balance.balance);

        // Update balance
        await this.supabase
          .from('token_balances')
          .update({ balance: balance.balance - deductAmount })
          .eq('id', balance.id);

        // Create transaction
        await this.supabase.from('token_transactions').insert({
          user_id: this.user.id,
          token_balance_id: balance.id,
          operation: 'debit',
          amount: -deductAmount,
          balance_before: balance.balance,
          balance_after: balance.balance - deductAmount,
          reason: 'ai_generation',
          ai_generation_id: generationId,
        });

        remaining -= deductAmount;
      }
    }

    if (remaining > 0) {
      throw new Error('Insufficient tokens');
    }
  }
}
```

#### 1.3 AI Generation Service (FASHN)

```typescript
// src/services/ai/fashn.service.ts
import FashnAI from 'fashn';

const fashn = new FashnAI({
  apiKey: process.env.FASHN_API_KEY!,
});

export interface TryOnParams {
  personImage: string;
  garmentImage: string;
  category?: 'tops' | 'bottoms' | 'one-pieces';
}

export class FashnService {
  async createVirtualTryOn(params: TryOnParams) {
    const result = await fashn.run({
      model_image: params.personImage,
      garment_image: params.garmentImage,
      category: params.category || 'tops',
    });

    return {
      taskId: result.id,
      status: result.status,
      outputUrl: result.output?.[0],
    };
  }

  async getTaskStatus(taskId: string) {
    const result = await fashn.getPrediction(taskId);

    return {
      status: result.status,
      outputUrl: result.output?.[0],
      error: result.error,
    };
  }
}
```

#### 1.4 AI Routes

```typescript
// src/routes/ai.routes.ts
import { Hono } from 'hono';
import { authMiddleware } from '../middleware/auth';
import { FashnService } from '../services/ai/fashn.service';
import { TokenBalanceService } from '../services/tokens/balance.service';

const ai = new Hono();

ai.use('/*', authMiddleware);

ai.post('/virtual-try-on', async (c) => {
  const user = c.get('user');
  const supabase = c.get('supabase');
  const body = await c.req.json();

  const tokenService = new TokenBalanceService(supabase, user);
  const balance = await tokenService.getAvailableBalance();

  const COST = 1; // 1 token per generation

  if (balance < COST) {
    return c.json(
      {
        error: 'Insufficient tokens',
        required: COST,
        available: balance,
      },
      402,
    );
  }

  // Create generation record
  const { data: generation } = await supabase
    .from('ai_generations')
    .insert({
      user_id: user.id,
      generation_type: 'virtual_try_on',
      status: 'pending',
      tokens_cost: COST,
      input_params: body,
      input_image_urls: [body.personImage, body.garmentImage],
    })
    .select()
    .single();

  // Debit tokens
  await tokenService.debitForGeneration(COST, generation.id);

  // Call FASHN AI
  try {
    const fashnService = new FashnService();
    const result = await fashnService.createVirtualTryOn({
      personImage: body.personImage,
      garmentImage: body.garmentImage,
      category: body.category,
    });

    // Update generation with external ID
    await supabase
      .from('ai_generations')
      .update({
        external_id: result.taskId,
        status: 'processing',
        started_at: new Date().toISOString(),
      })
      .eq('id', generation.id);

    return c.json({
      id: generation.id,
      status: 'processing',
      externalId: result.taskId,
    });
  } catch (error) {
    await supabase
      .from('ai_generations')
      .update({
        status: 'failed',
        error_message: error.message,
      })
      .eq('id', generation.id);

    return c.json({ error: 'Generation failed' }, 500);
  }
});

ai.get('/generations/:id/status', async (c) => {
  const user = c.get('user');
  const supabase = c.get('supabase');
  const id = c.req.param('id');

  const { data: generation } = await supabase
    .from('ai_generations')
    .select('*')
    .eq('id', id)
    .eq('user_id', user.id)
    .single();

  if (!generation) {
    return c.json({ error: 'Not found' }, 404);
  }

  // If still processing, check FASHN status
  if (generation.status === 'processing' && generation.external_id) {
    const fashnService = new FashnService();
    const status = await fashnService.getTaskStatus(generation.external_id);

    if (status.status === 'succeeded') {
      await supabase
        .from('ai_generations')
        .update({
          status: 'completed',
          output_image_urls: [status.outputUrl],
          completed_at: new Date().toISOString(),
        })
        .eq('id', id);

      generation.status = 'completed';
      generation.output_image_urls = [status.outputUrl];
    } else if (status.status === 'failed') {
      await supabase
        .from('ai_generations')
        .update({
          status: 'failed',
          error_message: status.error,
        })
        .eq('id', id);

      generation.status = 'failed';
    }
  }

  return c.json(generation);
});

export default ai;
```

### Ğ­Ñ‚Ğ°Ğ¿ 2: Payments & Webhooks (2 Ğ´Ğ½Ñ)

#### 2.1 YooKassa Service

```typescript
// src/services/payments/yookassa.service.ts
import crypto from 'crypto';

interface CreatePaymentParams {
  amount: number;
  currency?: string;
  description: string;
  returnUrl: string;
  metadata?: Record<string, any>;
}

export class YookassaService {
  private shopId: string;
  private secretKey: string;
  private apiBase = 'https://api.yookassa.ru';

  constructor() {
    this.shopId = process.env.YOOKASSA_SHOP_ID!;
    this.secretKey = process.env.YOOKASSA_SECRET_KEY!;
  }

  async createPayment(params: CreatePaymentParams) {
    const idempotenceKey = crypto.randomUUID();

    const response = await fetch(`${this.apiBase}/v3/payments`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Idempotence-Key': idempotenceKey,
        Authorization: `Basic ${Buffer.from(`${this.shopId}:${this.secretKey}`).toString('base64')}`,
      },
      body: JSON.stringify({
        amount: {
          value: params.amount.toFixed(2),
          currency: params.currency || 'RUB',
        },
        capture: true,
        confirmation: {
          type: 'redirect',
          return_url: params.returnUrl,
        },
        description: params.description,
        metadata: params.metadata || {},
      }),
    });

    const data = await response.json();

    if (!response.ok) {
      throw new Error(data.description || 'YooKassa error');
    }

    return {
      paymentId: data.id,
      confirmationUrl: data.confirmation?.confirmation_url,
      status: data.status,
    };
  }

  verifyWebhookSignature(body: string, signature: string): boolean {
    const expectedSignature = crypto
      .createHmac('sha256', this.secretKey)
      .update(body)
      .digest('hex');

    return crypto.timingSafeEqual(Buffer.from(signature), Buffer.from(expectedSignature));
  }
}
```

#### 2.2 Webhook Routes

```typescript
// src/routes/webhooks.routes.ts
import { Hono } from 'hono';
import { YookassaService } from '../services/payments/yookassa.service';
import { createClient } from '@supabase/supabase-js';

const webhooks = new Hono();

const supabase = createClient(process.env.SUPABASE_URL!, process.env.SUPABASE_SERVICE_KEY!);

webhooks.post('/yookassa', async (c) => {
  const rawBody = await c.req.text();
  const body = JSON.parse(rawBody);

  // Store webhook event
  await supabase.from('webhook_events').insert({
    source: 'yookassa',
    external_id: body.object?.id || body.event,
    event_type: body.event,
    payload: body,
    status: 'pending',
  });

  if (body.event === 'payment.succeeded') {
    const payment = body.object;

    // Update payment record
    await supabase
      .from('payments')
      .update({
        status: 'succeeded',
        external_status: payment.status,
        paid_at: new Date().toISOString(),
      })
      .eq('external_id', payment.id);

    // Credit tokens if token_pack purchase
    const { data: paymentRecord } = await supabase
      .from('payments')
      .select('*, user_id')
      .eq('external_id', payment.id)
      .single();

    if (paymentRecord?.payment_type === 'token_pack') {
      const { data: balance } = await supabase
        .from('token_balances')
        .select('*')
        .eq('user_id', paymentRecord.user_id)
        .eq('token_type', 'purchased_tokens')
        .single();

      if (balance) {
        await supabase
          .from('token_balances')
          .update({ balance: balance.balance + paymentRecord.tokens_amount })
          .eq('id', balance.id);
      } else {
        await supabase.from('token_balances').insert({
          user_id: paymentRecord.user_id,
          token_type: 'purchased_tokens',
          balance: paymentRecord.tokens_amount,
          source: 'purchase',
        });
      }
    }
  }

  return c.json({ success: true });
});

export default webhooks;
```

### Ğ­Ñ‚Ğ°Ğ¿ 3: Dashboard Frontend (4-5 Ğ´Ğ½ĞµĞ¹)

#### 3.1 Dashboard Layout

```tsx
// app/(dashboard)/layout.tsx
import { redirect } from 'next/navigation';
import { createServerClient } from '@/lib/supabase/server';
import { Sidebar } from '@/components/dashboard/Sidebar';

export default async function DashboardLayout({ children }: { children: React.ReactNode }) {
  const supabase = createServerClient();
  const {
    data: { user },
  } = await supabase.auth.getUser();

  if (!user) {
    redirect('/login');
  }

  return (
    <div className="min-h-screen bg-[#FAFAFA]">
      <Sidebar user={user} />
      <main className="lg:pl-72">
        <div className="px-4 py-10 sm:px-6 lg:px-8 lg:py-6">{children}</div>
      </main>
    </div>
  );
}
```

#### 3.2 Dashboard Home Page

```tsx
// app/(dashboard)/page.tsx
import { createServerClient } from '@/lib/supabase/server';
import { StatsCard } from '@/components/dashboard/StatsCard';
import { RecentGenerations } from '@/components/dashboard/RecentGenerations';

export default async function DashboardPage() {
  const supabase = createServerClient();
  const {
    data: { user },
  } = await supabase.auth.getUser();

  // Get user data
  const { data: userData } = await supabase
    .from('users')
    .select('*')
    .eq('supabase_id', user!.id)
    .single();

  // Get token balance
  const { data: balances } = await supabase
    .from('token_balances')
    .select('balance')
    .eq('user_id', userData.id);

  const totalTokens = balances?.reduce((sum, b) => sum + b.balance, 0) ?? 0;

  // Get subscription
  const { data: subscription } = await supabase
    .from('subscriptions')
    .select('*')
    .eq('user_id', userData.id)
    .single();

  // Get recent generations
  const { data: generations } = await supabase
    .from('ai_generations')
    .select('*')
    .eq('user_id', userData.id)
    .order('created_at', { ascending: false })
    .limit(6);

  // Get stats
  const { count: totalGenerations } = await supabase
    .from('ai_generations')
    .select('*', { count: 'exact', head: true })
    .eq('user_id', userData.id);

  const { count: successfulGenerations } = await supabase
    .from('ai_generations')
    .select('*', { count: 'exact', head: true })
    .eq('user_id', userData.id)
    .eq('status', 'completed');

  return (
    <div>
      {/* Header */}
      <div className="md:flex md:items-center md:justify-between mb-8">
        <div>
          <h1 className="text-2xl font-bold text-[#1A1A2E]">
            Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ, {userData.full_name || 'Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ'}!
          </h1>
          <p className="mt-1 text-sm text-[#666666]">Ğ’Ğ°Ñˆ AI-ÑÑ‚Ğ¸Ğ»Ğ¸ÑÑ‚ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ</p>
        </div>
      </div>

      {/* Stats Grid */}
      <div className="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8">
        <StatsCard
          title="Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ²"
          value={totalTokens}
          icon="coins"
          link={{ href: '/dashboard/tokens', label: 'ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ' }}
        />
        <StatsCard
          title="ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°"
          value={subscription?.plan === 'pro_monthly' ? 'Pro' : 'Free'}
          icon="badge"
          variant={subscription?.plan?.includes('pro') ? 'success' : 'default'}
          link={{
            href: '/dashboard/subscription',
            label: subscription?.plan?.includes('pro') ? 'Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ' : 'Ğ£Ğ»ÑƒÑ‡ÑˆĞ¸Ñ‚ÑŒ',
          }}
        />
        <StatsCard
          title="Ğ’ÑĞµĞ³Ğ¾ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹"
          value={totalGenerations || 0}
          icon="sparkles"
          subtitle={`${successfulGenerations || 0} ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ñ…`}
        />
        <StatsCard title="Ğ’ ÑÑ‚Ğ¾Ğ¼ Ğ¼ĞµÑÑÑ†Ğµ" value={0} icon="calendar" />
      </div>

      {/* Recent Generations */}
      <RecentGenerations generations={generations || []} />
    </div>
  );
}
```

#### 3.3 Sidebar Component

```tsx
// components/dashboard/Sidebar.tsx
'use client';

import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { User } from '@supabase/supabase-js';
import { cn } from '@/lib/utils';
import {
  HomeIcon,
  SparklesIcon,
  CurrencyDollarIcon,
  CreditCardIcon,
  Cog6ToothIcon,
} from '@heroicons/react/24/outline';

const navigation = [
  { name: 'Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ', href: '/dashboard', icon: HomeIcon },
  { name: 'AI-Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸', href: '/dashboard/generations', icon: SparklesIcon },
  { name: 'Ğ¢Ğ¾ĞºĞµĞ½Ñ‹', href: '/dashboard/tokens', icon: CurrencyDollarIcon },
  { name: 'ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°', href: '/dashboard/subscription', icon: CreditCardIcon },
  { name: 'ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸', href: '/dashboard/settings', icon: Cog6ToothIcon },
];

export function Sidebar({ user }: { user: User }) {
  const pathname = usePathname();

  return (
    <div className="hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-72 lg:flex-col">
      <div className="flex grow flex-col gap-y-5 overflow-y-auto bg-[#1A1A2E] px-6 pb-4">
        {/* Logo */}
        <div className="flex h-16 shrink-0 items-center border-b border-white/10">
          <Link href="/dashboard" className="flex items-center space-x-3">
            <span className="text-white text-2xl font-bold tracking-[3px]">OBRAZZ</span>
          </Link>
          <Link
            href="/"
            className="ml-auto text-xs text-white/50 hover:text-white transition-colors"
          >
            â† ĞĞ° ÑĞ°Ğ¹Ñ‚
          </Link>
        </div>

        {/* Navigation */}
        <nav className="flex flex-1 flex-col">
          <ul className="flex flex-1 flex-col gap-y-7">
            <li>
              <ul className="-mx-2 space-y-1">
                {navigation.map((item) => (
                  <li key={item.name}>
                    <Link
                      href={item.href}
                      className={cn(
                        'group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold',
                        pathname === item.href
                          ? 'bg-white/10 text-white'
                          : 'text-white/70 hover:text-white hover:bg-white/10',
                      )}
                    >
                      <item.icon className="h-6 w-6 shrink-0" />
                      {item.name}
                    </Link>
                  </li>
                ))}
              </ul>
            </li>

            {/* User info */}
            <li className="mt-auto">
              <div className="flex items-center gap-x-4 px-2 py-3 text-sm font-semibold text-white">
                <div className="h-8 w-8 rounded-full bg-white/10 flex items-center justify-center">
                  {user.email?.[0].toUpperCase()}
                </div>
                <span className="truncate">{user.email}</span>
              </div>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  );
}
```

### Ğ­Ñ‚Ğ°Ğ¿ 4: ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Auth Pages (1-2 Ğ´Ğ½Ñ)

#### 4.1 Login Page

```tsx
// app/(auth)/login/page.tsx
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { createBrowserClient } from '@/lib/supabase/client';

export default function LoginPage() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const router = useRouter();
  const supabase = createBrowserClient();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    setError(null);

    const { error } = await supabase.auth.signInWithPassword({
      email,
      password,
    });

    if (error) {
      setError(error.message);
      setLoading(false);
    } else {
      router.push('/dashboard');
    }
  };

  const handleOAuthLogin = async (provider: 'google' | 'apple') => {
    await supabase.auth.signInWithOAuth({
      provider,
      options: {
        redirectTo: `${window.location.origin}/auth/callback`,
      },
    });
  };

  return (
    <div className="flex min-h-screen flex-col justify-center py-12 sm:px-6 lg:px-8">
      <div className="sm:mx-auto sm:w-full sm:max-w-md">
        <h1 className="text-center text-3xl font-bold tracking-[3px] text-[#1A1A2E]">OBRAZZ</h1>
        <h2 className="mt-6 text-center text-2xl font-bold text-[#1A1A2E]">Ğ’Ñ…Ğ¾Ğ´ Ğ² Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚</h2>
      </div>

      <div className="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
        <div className="bg-white py-8 px-4 shadow-sm rounded-2xl sm:px-10 border border-[#E5E5E5]">
          {/* OAuth buttons */}
          <div className="space-y-3">
            <button
              onClick={() => handleOAuthLogin('google')}
              className="w-full flex items-center justify-center gap-3 rounded-full bg-white px-4 py-3 text-sm font-semibold text-[#1A1A2E] border border-[#E5E5E5] hover:bg-[#F5F5F5] transition-colors"
            >
              <GoogleIcon className="h-5 w-5" />
              Ğ’Ğ¾Ğ¹Ñ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Google
            </button>
            <button
              onClick={() => handleOAuthLogin('apple')}
              className="w-full flex items-center justify-center gap-3 rounded-full bg-[#1A1A2E] px-4 py-3 text-sm font-semibold text-white hover:opacity-90 transition-opacity"
            >
              <AppleIcon className="h-5 w-5" />
              Ğ’Ğ¾Ğ¹Ñ‚Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Apple
            </button>
          </div>

          <div className="mt-6 relative">
            <div className="absolute inset-0 flex items-center">
              <div className="w-full border-t border-[#E5E5E5]" />
            </div>
            <div className="relative flex justify-center text-sm">
              <span className="px-2 bg-white text-[#999999]">Ğ¸Ğ»Ğ¸</span>
            </div>
          </div>

          {/* Email form */}
          <form className="mt-6 space-y-6" onSubmit={handleSubmit}>
            {error && <div className="rounded-lg bg-red-50 p-4 text-sm text-red-600">{error}</div>}

            <div>
              <label htmlFor="email" className="block text-sm font-medium text-[#1A1A2E]">
                Email
              </label>
              <input
                id="email"
                type="email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                required
                className="mt-1 block w-full rounded-lg border border-[#E5E5E5] bg-[#F5F5F5] px-4 py-3 text-[#1A1A2E] placeholder-[#999999] focus:border-[#1A1A2E] focus:outline-none focus:ring-1 focus:ring-[#1A1A2E]"
                placeholder="you@example.com"
              />
            </div>

            <div>
              <label htmlFor="password" className="block text-sm font-medium text-[#1A1A2E]">
                ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ
              </label>
              <input
                id="password"
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                required
                className="mt-1 block w-full rounded-lg border border-[#E5E5E5] bg-[#F5F5F5] px-4 py-3 text-[#1A1A2E] placeholder-[#999999] focus:border-[#1A1A2E] focus:outline-none focus:ring-1 focus:ring-[#1A1A2E]"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              />
            </div>

            <button
              type="submit"
              disabled={loading}
              className="w-full rounded-full bg-[#1A1A2E] px-4 py-3 text-sm font-semibold text-white hover:opacity-90 transition-opacity disabled:opacity-50"
            >
              {loading ? 'Ğ’Ñ…Ğ¾Ğ´...' : 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸'}
            </button>
          </form>

          <p className="mt-6 text-center text-sm text-[#666666]">
            ĞĞµÑ‚ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°?{' '}
            <Link href="/signup" className="font-semibold text-[#1A1A2E] hover:underline">
              Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ
            </Link>
          </p>
        </div>
      </div>
    </div>
  );
}
```

### Ğ­Ñ‚Ğ°Ğ¿ 5: Rails Admin Isolation (1 Ğ´ĞµĞ½ÑŒ)

- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ `obrazz-admin`
- [ ] Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ non-admin ĞºĞ¾Ğ´
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ read-only Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Supabase
- [ ] Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ½Ğ° Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Render Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚

### Ğ­Ñ‚Ğ°Ğ¿ 6: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹ (2 Ğ´Ğ½Ñ)

- [ ] E2E Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… flows
- [ ] Load testing
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°
- [ ] Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹
- [ ] ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ DNS (ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾)

---

## ğŸ“Š Free Tier Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ Ğ¸ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ

### Vercel Hobby

| Ğ ĞµÑÑƒÑ€Ñ           | Ğ›Ğ¸Ğ¼Ğ¸Ñ‚                | Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ               |
| ---------------- | -------------------- | --------------------------- |
| Functions        | 1M invocations/month | Dashboard pages + API proxy |
| Bandwidth        | 100 GB/month         | Static + SSR                |
| Build minutes    | 6000/month           | CI/CD                       |
| Function timeout | 300s                 | Ğ”Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾                  |

### Render Free

| Ğ ĞµÑÑƒÑ€Ñ       | Ğ›Ğ¸Ğ¼Ğ¸Ñ‚           | Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ         |
| ------------ | --------------- | --------------------- |
| Web Services | 750 hours/month | ~31 Ğ´Ğ½Ñ (Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾)  |
| Memory       | 512 MB          | Hono ~50MB            |
| Sleep        | ĞŸĞ¾ÑĞ»Ğµ 15 Ğ¼Ğ¸Ğ½    | Cold start ~100-200ms |

### Supabase Free

| Ğ ĞµÑÑƒÑ€Ñ         | Ğ›Ğ¸Ğ¼Ğ¸Ñ‚          | Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ        |
| -------------- | -------------- | -------------------- |
| Database       | 500 MB         | Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ ~50MB |
| Storage        | 1 GB           | AI outputs           |
| Auth MAU       | 50,000         | Ğ‘Ğ¾Ğ»ĞµĞµ Ñ‡ĞµĞ¼ Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ |
| Edge Functions | 500K/month     | ĞĞ• Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼        |
| Pausing        | ĞŸĞ¾ÑĞ»Ğµ 1 Ğ½ĞµĞ´ĞµĞ»Ğ¸ | Ping job Ğ½Ğ° Vercel   |

---

## âš ï¸ Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Ğ¼Ğ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ

| Ğ Ğ¸ÑĞº                       | Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ | Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ     | ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ                             |
| -------------------------- | ----------- | ----------- | ------------------------------------- |
| Render sleep Ğ·Ğ°Ğ¼ĞµĞ´Ğ»ÑĞµÑ‚ UX  | Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ     | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ     | Keepalive ping ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 10 Ğ¼Ğ¸Ğ½          |
| Supabase pause             | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ     | Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ     | Vercel cron job Ğ¿Ğ¸Ğ½Ğ³ÑƒĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 5 Ğ´Ğ½ĞµĞ¹ |
| FASHN API downtime         | ĞĞ¸Ğ·ĞºĞ°Ñ      | Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ     | Graceful degradation, retry Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°    |
| ĞŸÑ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸Ğµ free tier       | ĞĞ¸Ğ·ĞºĞ°Ñ      | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ     | ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ usage, alerts              |
| ĞŸĞ¾Ñ‚ĞµÑ€Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ | ĞĞ¸Ğ·ĞºĞ°Ñ      | ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ | Backup Ğ‘Ğ” Ğ¿ĞµÑ€ĞµĞ´ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹             |

---

## â±ï¸ ĞÑ†ĞµĞ½ĞºĞ° Ñ‚Ñ€ÑƒĞ´Ğ¾Ğ·Ğ°Ñ‚Ñ€Ğ°Ñ‚

| Ğ­Ñ‚Ğ°Ğ¿       | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸                      | ĞÑ†ĞµĞ½ĞºĞ°         |
| ---------- | --------------------------- | -------------- |
| **Ğ­Ñ‚Ğ°Ğ¿ 0** | ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ°                  | 1 Ğ´ĞµĞ½ÑŒ         |
| **Ğ­Ñ‚Ğ°Ğ¿ 1** | Core API (auth, tokens, AI) | 3-4 Ğ´Ğ½Ñ        |
| **Ğ­Ñ‚Ğ°Ğ¿ 2** | Payments & Webhooks         | 2 Ğ´Ğ½Ñ          |
| **Ğ­Ñ‚Ğ°Ğ¿ 3** | Dashboard Frontend          | 4-5 Ğ´Ğ½ĞµĞ¹       |
| **Ğ­Ñ‚Ğ°Ğ¿ 4** | Auth Pages                  | 1-2 Ğ´Ğ½Ñ        |
| **Ğ­Ñ‚Ğ°Ğ¿ 5** | Rails Admin Isolation       | 1 Ğ´ĞµĞ½ÑŒ         |
| **Ğ­Ñ‚Ğ°Ğ¿ 6** | Testing & Deploy            | 2 Ğ´Ğ½Ñ          |
| **Ğ‘ÑƒÑ„ĞµÑ€**  | ĞĞµĞ¿Ñ€ĞµĞ´Ğ²Ğ¸Ğ´ĞµĞ½Ğ½Ğ¾Ğµ              | 2 Ğ´Ğ½Ñ          |
| **Ğ˜Ğ¢ĞĞ“Ğ**  |                             | **16-19 Ğ´Ğ½ĞµĞ¹** |

---

## ğŸ“ Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ĞµĞ²

```
GitHub:
â”œâ”€â”€ obrazz/                          # Mobile App (React Native)
â”œâ”€â”€ obrazz-landing/                  # Landing + Dashboard (Next.js) â†’ Vercel
â”œâ”€â”€ obrazz-api/                      # Backend API (Node.js/Hono) â†’ Render
â””â”€â”€ obrazz-admin/                    # Admin Panel (Rails) â†’ Render (Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚)
```

---

## âœ… Checklist Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

### ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ°

- [ ] Backup Supabase Ğ‘Ğ”
- [ ] Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑĞµ env variables
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸

### Node.js Backend

- [ ] Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Hono
- [ ] Auth middleware
- [ ] Token service
- [ ] AI service (FASHN)
- [ ] Payment service (YooKassa)
- [ ] Webhook handlers
- [ ] User routes
- [ ] Dockerfile + render.yaml
- [ ] Deploy Ğ½Ğ° Render

### Next.js Dashboard

- [ ] Dashboard layout
- [ ] Home page
- [ ] Generations page
- [ ] Tokens page
- [ ] Subscription page
- [ ] Settings page
- [ ] Login/Signup pages
- [ ] API proxy routes
- [ ] Deploy Ğ½Ğ° Vercel

### Rails Admin

- [ ] Ğ˜Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ admin ĞºĞ¾Ğ´
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹
- [ ] Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ¤Ğ¸Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

- [ ] E2E Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- [ ] DNS Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
- [ ] ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
- [ ] Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

---

## ğŸ“š ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

### A. Environment Variables

#### Node.js Backend (.env)

```env
# Supabase
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_SERVICE_KEY=eyJ...
SUPABASE_JWT_SECRET=your-jwt-secret

# FASHN AI
FASHN_API_KEY=fashn_xxx

# YooKassa
YOOKASSA_SHOP_ID=xxx
YOOKASSA_SECRET_KEY=xxx

# App
PORT=3000
NODE_ENV=production
CORS_ORIGINS=https://obrazz.app,https://www.obrazz.app
```

#### Next.js Dashboard (.env.local)

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJ...

# API
NEXT_PUBLIC_API_URL=https://api.obrazz.app

# App
NEXT_PUBLIC_APP_URL=https://obrazz.app
```

### B. Render Configuration (render.yaml)

```yaml
services:
  - type: web
    name: obrazz-api
    runtime: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    envVars:
      - key: NODE_ENV
        value: production
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_SERVICE_KEY
        sync: false
      - key: SUPABASE_JWT_SECRET
        sync: false
      - key: FASHN_API_KEY
        sync: false
      - key: YOOKASSA_SHOP_ID
        sync: false
      - key: YOOKASSA_SECRET_KEY
        sync: false
```

### C. Dockerfile Ğ´Ğ»Ñ Node.js

```dockerfile
FROM node:20-alpine AS builder

WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM node:20-alpine AS runner

WORKDIR /app
ENV NODE_ENV=production

COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json ./

EXPOSE 3000
CMD ["node", "dist/index.js"]
```

---

**Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 30 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026  
**ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:** 30 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026  
**Ğ’ĞµÑ€ÑĞ¸Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°:** 1.0.0
