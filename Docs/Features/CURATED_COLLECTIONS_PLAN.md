# ğŸ“¦ Curated Collections (ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸) â€” ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

> **Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 22 Ğ´ĞµĞºĞ°Ğ±Ñ€Ñ 2025  
> **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ  
> **ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** High  
> **ĞĞ²Ñ‚Ğ¾Ñ€:** AI Assistant  
> **Estimated Timeline:** 2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸

---

## ğŸ“‹ ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

1. [ĞĞ±Ğ·Ğ¾Ñ€ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ°](#1-Ğ¾Ğ±Ğ·Ğ¾Ñ€-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ°)
2. [ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹](#2-Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°-ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹)
3. [ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…](#3-Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ-Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
4. [Backend (Supabase)](#4-backend-supabase)
5. [ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ](#5-Ğ°Ğ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ)
6. [Frontend (React Native)](#6-frontend-react-native)
7. [ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸](#7-Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹-Ğ¿Ğ»Ğ°Ğ½-Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸)
8. [API Reference](#8-api-reference)
9. [UI/UX ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸](#9-uiux-ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸)

---

## 1. ĞĞ±Ğ·Ğ¾Ñ€ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»Ğ°

### 1.1 Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸?

**ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ (Curated Collections)** â€” ÑÑ‚Ğ¾ ĞºÑƒÑ€Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğµ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ¼ ÑĞ¿Ğ¸ÑĞºĞ¸ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ² Ğ¸Ğ· Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚-Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¾Ğ², ÑĞ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ¾ Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸ĞºĞ°Ğ¼ (ÑÑ‚Ğ¸Ğ»Ğ¸, ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ, ÑĞµĞ·Ğ¾Ğ½Ñ‹, Ğ±Ñ€ĞµĞ½Ğ´Ñ‹ Ğ¸ Ñ‚.Ğ´.).

### 1.2 ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸

| Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ                       | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ                                                      |
| ----------------------------- | ------------------------------------------------------------- |
| **ĞšĞ°Ñ€ÑƒÑĞµĞ»ÑŒ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº**         | ĞŸĞ»Ğ¸Ñ‚ĞºĞ¸ Ğ½Ğ° Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğµ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ ĞºĞ°Ñ€ÑƒÑĞµĞ»Ğ¸ ÑÑ‚Ğ¸Ğ»ĞµĞ¹             |
| **Masonry-ÑĞ¿Ğ¸ÑĞ¾Ğº**            | Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°Ğ¼Ğ¸ Ğ² 2-ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ ÑĞµÑ‚ĞºĞµ             |
| **Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°** | ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° + Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ³Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ± + Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ½Ğ° Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº |
| **ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ**              | Rails Dashboard/Admin Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼                |
| **Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ**              | Ğ’ÑĞµ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ Ğ²Ğ¸Ğ´Ğ½Ñ‹ Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ              |

### 1.3 User Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ğ“Ğ›ĞĞ’ĞĞĞ¯ Ğ¡Ğ¢Ğ ĞĞĞ˜Ğ¦Ğ                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Y2K    â”‚  â”‚Old Moneyâ”‚  â”‚  Sport  â”‚  â”‚ Casual  â”‚  â† ĞšĞ°Ñ€ÑƒÑĞµĞ»ÑŒ â”‚
â”‚  â”‚  Guy    â”‚  â”‚  Style  â”‚  â”‚  Look   â”‚  â”‚ Friday  â”‚    Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚       â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ Tap
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ¡Ğ¢Ğ ĞĞĞ˜Ğ¦Ğ ĞŸĞĞ”Ğ‘ĞĞ ĞšĞ˜                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ â† Gift Ideas                            ğŸ”— â†•ï¸               â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ â”‚  Y2K Guy    â”‚  â”‚      BANNER IMAGE                       â”‚â”‚â”‚
â”‚  â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                       â”‚
â”‚  â”‚ â”‚             â”‚ â”‚  â”‚ â”‚             â”‚ â”‚   â† Masonry Grid      â”‚
â”‚  â”‚ â”‚   Jacket    â”‚ â”‚  â”‚ â”‚   Jeans     â”‚ â”‚     2 columns         â”‚
â”‚  â”‚ â”‚   $21.49    â”‚ â”‚  â”‚ â”‚   $39.99    â”‚ â”‚                       â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                       â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                       â”‚
â”‚  â”‚ â”‚             â”‚ â”‚  â”‚ â”‚             â”‚ â”‚                       â”‚
â”‚  â”‚ â”‚  Pokemon    â”‚ â”‚  â”‚ â”‚   Jersey    â”‚ â”‚                       â”‚
â”‚  â”‚ â”‚   $59.99    â”‚ â”‚  â”‚ â”‚   $23.99    â”‚ â”‚                       â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ Tap Ğ½Ğ° Ñ‚Ğ¾Ğ²Ğ°Ñ€
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Ğ”Ğ•Ğ¢ĞĞ›Ğ¬ĞĞĞ¯ Ğ¡Ğ¢Ğ ĞĞĞ˜Ğ¦Ğ Ğ¢ĞĞ’ĞĞ Ğ                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â”‚              [Ğ˜Ğ—ĞĞ‘Ğ ĞĞ–Ğ•ĞĞ˜Ğ• Ğ¢ĞĞ’ĞĞ Ğ]                           â”‚â”‚
â”‚  â”‚                                                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â”‚  IYTR Men's Colorblock Windbreaker                              â”‚
â”‚  ğŸ’° $21.49                                                      â”‚
â”‚  ğŸª Amazon                                                      â”‚
â”‚  ğŸ“¦ Category: Outerwear                                         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ â• Add to Wardrobe  â”‚  â”‚  ğŸ”— Open in Store   â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### 2.1 ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° (Ñ†ĞµĞ»ĞµĞ²Ğ¾Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ Ğ¿Ğ¾Ğ´ ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ Ruby on Rails backend)

ĞšĞ»ÑÑ‡ĞµĞ²Ğ°Ñ Ğ¸Ğ´ĞµÑ: **Supabase Ğ¾ÑÑ‚Ğ°Ñ‘Ñ‚ÑÑ data/storage ÑĞ»Ğ¾ĞµĞ¼**, Ğ° **Rails ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑÑ ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¼ backend-ÑĞ»Ğ¾ĞµĞ¼**:

- Mobile App Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² Rails API (ĞµĞ´Ğ¸Ğ½Ğ°Ñ Ğ°ÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ, ĞºÑÑˆ, Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°, future-Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)
- Rails Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚/Ğ¿Ğ¸ÑˆĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ Ğ² Supabase (Postgres + Storage) Ñ‡ĞµÑ€ĞµĞ· service-role
- ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº â€” Ñ‡Ğ°ÑÑ‚ÑŒ Rails (Dashboard/Admin)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         RAILS BACKEND                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ API v1 Ğ´Ğ»Ñ Mobile                                                â”‚â”‚
â”‚  â”‚  - GET /api/v1/collections                                       â”‚â”‚
â”‚  â”‚  - GET /api/v1/collections/:id/items                             â”‚â”‚
â”‚  â”‚  - GET /api/v1/collection_items/:id                              â”‚â”‚
â”‚  â”‚  - POST /api/v1/collections/events (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)                 â”‚â”‚
â”‚  â”‚                                                                 â”‚â”‚
â”‚  â”‚ Dashboard/Admin (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¾Ğ²)                             â”‚â”‚
â”‚  â”‚  - CRUD Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº + Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²                                       â”‚â”‚
â”‚  â”‚  - Upload Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ + Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ thumbnail                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ service-role (server-side)
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SUPABASE                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   collections   â”‚  â”‚ collection_itemsâ”‚  â”‚   Storage:          â”‚  â”‚
â”‚  â”‚   (Postgres)    â”‚  â”‚   (Postgres)    â”‚  â”‚   collections/*     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  RLS: ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñƒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ SELECT Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ (Ğ±ĞµĞ· write-Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸Ğº)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ HTTPS
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MOBILE APP (React Native)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚CollectionsCarou-â”‚  â”‚ CollectionScreenâ”‚  â”‚CollectionItemDetail â”‚  â”‚
â”‚  â”‚sel (Home)       â”‚  â”‚ (Masonry List)  â”‚  â”‚   (Item View)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Services: collectionsApi.ts (calls Rails API)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° (Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾ Ğ¿Ğ¾Ğ´ Ruby on Rails)

Ğ§Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ»Ğ°Ğ½Ñ‹ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ°Ğ¼ Ğ¸ Ğ¿Ğ¾ backend Ğ±Ñ‹Ğ»Ğ¸ ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¼Ğ¸, **Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ¶Ğ¸Ñ‚ÑŒ Ğ² Rails**:

- ĞµĞ´Ğ¸Ğ½Ğ°Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¾Ğ² (Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ `AdminUser` Ğ² Rails)
- ĞµĞ´Ğ¸Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° (server-side, Ğ±ĞµĞ· Ğ²Ñ‹Ğ´Ğ°Ñ‡Ğ¸ Ğ¿Ñ€Ğ°Ğ² Ğ½Ğ° write ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°Ğ¼)
- Ğ¿Ñ€Ğ¾Ñ‰Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºÑƒ, ĞºÑÑˆ, Ñ„Ğ¾Ğ½Ğ¾Ğ²ÑƒÑ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºÑƒ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ (Solid Queue; Sidekiq Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
- Ğ²ĞµĞ±-Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ° (Rails Views + Hotwire) â€” ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼

---

## 3. ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### 3.1 TypeScript Types

```typescript
// types/models/collection.ts

export interface Collection {
  id: string;
  title: string;
  titleEn?: string;
  description?: string;
  bannerUrl?: string;
  gradient: [string, string];
  sortOrder: number;
  isActive: boolean;
  itemsCount: number;
  createdAt: Date;
  updatedAt: Date;
}

export interface CollectionItem {
  id: string;
  collectionId: string;
  title: string;
  description?: string;
  imageUrl: string;
  thumbnailUrl?: string;
  imageWidth?: number;
  imageHeight?: number;
  sourceUrl: string;
  sourceName: string;
  price?: number;
  currency?: string;
  category?: string;
  colors?: unknown[];
  sortOrder: number;
  isActive: boolean;
  metadata?: CollectionItemMetadata;
  createdAt: Date;
  updatedAt: Date;
}

export interface CollectionItemMetadata {
  brand?: string;
  size?: string[];
  material?: string;
  originalPrice?: number;
  discount?: number;
  inStock?: boolean;
  aiTags?: string[];
}

export interface CollectionTile {
  id: string;
  title: string;
  gradient: [string, string];
  bannerUrl?: string;
  itemsCount: number;
}
```

### 3.2 Database Schema (Supabase PostgreSQL)

```sql
CREATE TABLE public.collections (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  title TEXT NOT NULL,
  title_en TEXT,
  description TEXT,
  banner_url TEXT,
  gradient JSONB DEFAULT '["#667eea", "#764ba2"]',
  sort_order INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT false,
  items_count INTEGER DEFAULT 0,
  metadata JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE public.collection_items (
  id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,
  collection_id UUID REFERENCES public.collections(id) ON DELETE CASCADE NOT NULL,
  title TEXT NOT NULL,
  description TEXT,
  image_url TEXT NOT NULL,
  thumbnail_url TEXT,
  image_width INTEGER,
  image_height INTEGER,
  source_url TEXT NOT NULL,
  source_name TEXT NOT NULL,
  price DECIMAL(10, 2),
  currency TEXT DEFAULT 'USD',
  category TEXT,
  colors JSONB DEFAULT '[]',
  sort_order INTEGER DEFAULT 0,
  is_active BOOLEAN DEFAULT true,
  metadata JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_collections_active ON public.collections(is_active, sort_order);
CREATE INDEX idx_collection_items_active ON public.collection_items(collection_id, is_active, sort_order);

ALTER TABLE public.collections ENABLE ROW LEVEL SECURITY;
ALTER TABLE public.collection_items ENABLE ROW LEVEL SECURITY;

-- ĞšĞ»Ğ¸ĞµĞ½Ñ‚ Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ. ĞŸĞ¸ÑˆĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Rails Ñ‡ĞµÑ€ĞµĞ· service-role.
CREATE POLICY "Published collections are viewable"
  ON public.collections FOR SELECT
  USING (auth.role() = 'authenticated' AND is_active = true);

CREATE POLICY "Published collection items are viewable"
  ON public.collection_items FOR SELECT
  USING (
    auth.role() = 'authenticated'
    AND is_active = true
    AND EXISTS (
      SELECT 1 FROM public.collections
      WHERE collections.id = collection_items.collection_id
        AND collections.is_active = true
    )
  );

CREATE OR REPLACE FUNCTION recalc_collection_items_count(p_collection_id UUID)
RETURNS VOID AS $$
BEGIN
  UPDATE collections
  SET items_count = (
    SELECT COUNT(*)::int
    FROM collection_items
    WHERE collection_id = p_collection_id AND is_active = true
  ),
  updated_at = NOW()
  WHERE id = p_collection_id;
END;
$$ LANGUAGE plpgsql;

CREATE OR REPLACE FUNCTION on_collection_items_changed()
RETURNS TRIGGER AS $$
BEGIN
  IF TG_OP = 'INSERT' THEN
    PERFORM recalc_collection_items_count(NEW.collection_id);
  ELSIF TG_OP = 'DELETE' THEN
    PERFORM recalc_collection_items_count(OLD.collection_id);
  ELSIF TG_OP = 'UPDATE' THEN
    IF NEW.collection_id IS DISTINCT FROM OLD.collection_id THEN
      PERFORM recalc_collection_items_count(OLD.collection_id);
      PERFORM recalc_collection_items_count(NEW.collection_id);
    ELSIF NEW.is_active IS DISTINCT FROM OLD.is_active THEN
      PERFORM recalc_collection_items_count(NEW.collection_id);
    END IF;
  END IF;

  RETURN NULL;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_collection_items_changed
AFTER INSERT OR UPDATE OR DELETE ON collection_items
FOR EACH ROW EXECUTE FUNCTION on_collection_items_changed();

CREATE OR REPLACE FUNCTION update_updated_at()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_collections_updated
BEFORE UPDATE ON collections
FOR EACH ROW EXECUTE FUNCTION update_updated_at();

CREATE TRIGGER trigger_collection_items_updated
BEFORE UPDATE ON collection_items
FOR EACH ROW EXECUTE FUNCTION update_updated_at();
```

### 3.3 Supabase Storage Structure

```
storage/
â””â”€â”€ collections/                    # Bucket for collection assets
    â”œâ”€â”€ banners/                    # Collection banner images
    â”‚   â”œâ”€â”€ y2k-guy-banner.jpg
    â”‚   â”œâ”€â”€ old-money-banner.jpg
    â”‚   â””â”€â”€ ...
  â””â”€â”€ items/                      # Collection item images
    â”œâ”€â”€ {collection_id}/
    â”‚   â”œâ”€â”€ full/
    â”‚   â”‚   â”œâ”€â”€ item-001.jpg
    â”‚   â”‚   â””â”€â”€ ...
    â”‚   â””â”€â”€ thumb/
    â”‚       â”œâ”€â”€ item-001.jpg
    â”‚       â””â”€â”€ ...
    â””â”€â”€ ...
```

**Storage Policies:**

```sql
-- Read access for authenticated users (Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ²ÑĞµĞ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ)
CREATE POLICY "Public read access for collection images"
ON storage.objects FOR SELECT
USING (bucket_id = 'collections' AND auth.role() = 'authenticated');

-- Server write access (Rails uses service-role)
CREATE POLICY "Service role write access for collection images"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'collections' AND auth.role() = 'service_role'
);

CREATE POLICY "Service role update access for collection images"
ON storage.objects FOR UPDATE
USING (
  bucket_id = 'collections' AND auth.role() = 'service_role'
)
WITH CHECK (
  bucket_id = 'collections' AND auth.role() = 'service_role'
);

CREATE POLICY "Service role delete access for collection images"
ON storage.objects FOR DELETE
USING (
  bucket_id = 'collections' AND auth.role() = 'service_role'
);
```

---

## 4. Backend (Rails + Supabase)

Ğ¦ĞµĞ»ÑŒ: **ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ backend ÑĞ»Ğ¾Ğ¹ Ğ² Rails** Ğ´Ğ»Ñ API, Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸, ĞºÑÑˆĞ° Ğ¸ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¸.

### 4.1 Rails API (Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ)

Mobile App Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ² Rails Ñ Supabase JWT:

- `Authorization: Bearer <supabase_access_token>`
- Rails Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚ JWT (ĞºĞ°Ğº Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¾ Ğ² backend-Ğ¿Ğ»Ğ°Ğ½Ğµ) Ğ¸ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ.

### 4.2 Rails Service Layer (Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Supabase)

Rails Ğ½Ğµ Ğ¾Ñ‚Ğ´Ğ°Ñ‘Ñ‚ service-role Ğ½Ğ°Ñ€ÑƒĞ¶Ñƒ. Ğ’ÑĞµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ (ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ/Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº, Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹) Ğ¸Ğ´ÑƒÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ server-side.

Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²:

- `Supabase::CollectionsService` â€” CRUD Ğ´Ğ»Ñ `collections`, `collection_items` Ñ‡ĞµÑ€ĞµĞ· Supabase REST (`/rest/v1/*`)
- `Supabase::StorageService` â€” upload Ğ² Storage bucket `collections`
- `Collections::Query` â€” ÑĞ±Ğ¾Ñ€ĞºĞ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² Ğ´Ğ»Ñ API (Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ, ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°)

### 4.3 Database Functions (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

```sql
-- Function to get collections with items count
CREATE OR REPLACE FUNCTION get_active_collections()
RETURNS TABLE (
  id UUID,
  title TEXT,
  title_en TEXT,
  banner_url TEXT,
  gradient JSONB,
  items_count INTEGER,
  sort_order INTEGER
) AS $$
BEGIN
  RETURN QUERY
  SELECT
    c.id,
    c.title,
    c.title_en,
    c.banner_url,
    c.gradient,
    c.items_count,
    c.sort_order
  FROM collections c
  WHERE c.is_active = true
  ORDER BY c.sort_order ASC, c.created_at DESC;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- Function to get collection items with pagination
CREATE OR REPLACE FUNCTION get_collection_items(
  p_collection_id UUID,
  p_limit INTEGER DEFAULT 20,
  p_offset INTEGER DEFAULT 0
)
RETURNS TABLE (
  id UUID,
  title TEXT,
  description TEXT,
  image_url TEXT,
  thumbnail_url TEXT,
  image_width INTEGER,
  image_height INTEGER,
  source_url TEXT,
  source_name TEXT,
  price DECIMAL,
  currency TEXT,
  category TEXT,
  colors JSONB,
  metadata JSONB
) AS $$
BEGIN
  RETURN QUERY
  SELECT
    ci.id,
    ci.title,
    ci.description,
    ci.image_url,
    ci.thumbnail_url,
    ci.image_width,
    ci.image_height,
    ci.source_url,
    ci.source_name,
    ci.price,
    ci.currency,
    ci.category,
    ci.colors,
    ci.metadata
  FROM collection_items ci
  JOIN collections c ON c.id = ci.collection_id
  WHERE ci.collection_id = p_collection_id
    AND ci.is_active = true
    AND c.is_active = true
  ORDER BY ci.sort_order ASC, ci.created_at DESC
  LIMIT p_limit
  OFFSET p_offset;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;
```

ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ: ÑÑ‚Ğ¸ RPC Ğ¿Ğ¾Ğ»ĞµĞ·Ğ½Ñ‹ ĞºĞ°Ğº â€œÑƒÑĞºĞ¾Ñ€Ğ¸Ñ‚ĞµĞ»Ğ¸â€ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ², Ğ½Ğ¾ **Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ğ¾ Ğº Ğ½Ğ¸Ğ¼ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ** â€” Ğ¾Ğ½Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ Ğº Rails API.

---

## 5. ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (Rails)

### 5.1 ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ° Ğ² Rails â€” ÑĞ°Ğ¼Ñ‹Ğ¹ Ñ‡Ğ¸ÑÑ‚Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚

- Ğ¾Ğ´Ğ¸Ğ½ backend ĞºĞ¾Ğ½Ñ‚ÑƒÑ€ (ĞºĞ°Ğº Ğ² backend-Ğ¿Ğ»Ğ°Ğ½Ğµ)
- Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸/ÑĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
- Ğ¿Ñ€Ğ¾Ñ‰Ğµ Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ñ‚ÑŒ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ (service-role Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ)
- Ğ¿Ñ€Ğ¾Ñ‰Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ„Ğ¾Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ (thumbnail/Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞºĞ°Ñ€Ñ‚Ğ¸Ğ½Ğ¾Ğº, Ğ¿ĞµÑ€ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´ ÑÑÑ‹Ğ»Ğ¾Ğº, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°)

### 5.2 ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¸ (MVP)

- CRUD `collections` (title, title_en, description, gradient, sort_order, is_active, banner)
- CRUD `collection_items` (title, image, source_url, source_name, price, currency, category, is_active, sort_order)
- Upload Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ² Supabase Storage + Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ `thumbnail_url` + Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ `image_width/height`

### 5.3 Ğ Ğ¾Ğ»Ğ¸ Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿

- Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ `AdminUser` (custom + `has_secure_password`) Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ° Ğ² `/admin` (ÑĞµĞ¹Ñ‡Ğ°Ñ Ğ·Ğ°Ñ‰Ğ¸Ñ‰ĞµĞ½Ğ¾ HTTP Basic)
- Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¾Ğ² **Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ°** Ğ±Ñ‹Ñ‚ÑŒ Ğ² Supabase Auth, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ ÑĞ¼ĞµÑˆĞ¸Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ¾Ğ¼ĞµĞ½Ñ‹ â€œĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñâ€ Ğ¸ â€œĞ°Ğ´Ğ¼Ğ¸Ğ½ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ°â€

ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ: Devise Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¶Ğµ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾), ĞµÑĞ»Ğ¸ Ğ¿Ğ¾ÑĞ²ÑÑ‚ÑÑ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ñ‹Ğ¼ admin-ÑĞµÑÑĞ¸ÑĞ¼/2FA/ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ñ€Ğ¾Ğ»ÑĞ¼Ğ¸.

---

## 6. Frontend (React Native)

### 6.1 ĞĞ¾Ğ²Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

```
components/
â”œâ”€â”€ collections/
â”‚   â”œâ”€â”€ CollectionsCarousel.tsx      # ĞšĞ°Ñ€ÑƒÑĞµĞ»ÑŒ Ğ½Ğ° Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¹
â”‚   â”œâ”€â”€ CollectionTile.tsx           # ĞŸĞ»Ğ¸Ñ‚ĞºĞ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸
â”‚   â”œâ”€â”€ CollectionMasonry.tsx        # Masonry-ÑĞµÑ‚ĞºĞ° Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²
â”‚   â””â”€â”€ CollectionItemCard.tsx       # ĞšĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ° Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° Ğ² ÑĞµÑ‚ĞºĞµ

app/
â”œâ”€â”€ collection/
â”‚   â”œâ”€â”€ [id].tsx                     # Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ (masonry list)
â”‚   â””â”€â”€ item/
â”‚       â””â”€â”€ [itemId].tsx             # Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°

services/
â”œâ”€â”€ collections/
â”‚   â”œâ”€â”€ collectionsApi.ts            # Calls Rails API (read-only Ğ´Ğ»Ñ ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ğ°)
â”‚   â””â”€â”€ index.ts

store/
â”œâ”€â”€ collections/
â”‚   â””â”€â”€ collectionsStore.ts          # Zustand store (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

types/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ collection.ts                # Ğ¢Ğ¸Ğ¿Ñ‹ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº
```

### 6.2 ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

#### CollectionsCarousel.tsx

```typescript
// components/collections/CollectionsCarousel.tsx

import { Collection } from '@/types/models/collection';
import { LinearGradient } from 'expo-linear-gradient';
import { useRouter } from 'expo-router';
import React, { useEffect, useRef, useState } from 'react';
import {
  Dimensions,
  FlatList,
  Image,
  StyleSheet,
  Text,
  TouchableOpacity,
  View,
} from 'react-native';
import { collectionsApi } from '@/services/collections';

const { width: SCREEN_WIDTH } = Dimensions.get('window');
const TILE_WIDTH = SCREEN_WIDTH - 64;
const TILE_HEIGHT = 160;
const TILE_GAP = 16;

export default function CollectionsCarousel() {
  const router = useRouter();
  const flatListRef = useRef<FlatList>(null);
  const [collections, setCollections] = useState<Collection[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadCollections();
  }, []);

  const loadCollections = async () => {
    try {
      const data = await collectionsApi.getActiveCollections();
      setCollections(data);
    } catch (error) {
      console.error('Failed to load collections:', error);
    } finally {
      setLoading(false);
    }
  };

  // Infinite loop data
  const infiniteData = collections.length > 0
    ? [...collections, ...collections, ...collections]
    : [];
  const dataLength = collections.length;

  useEffect(() => {
    if (dataLength > 0 && flatListRef.current) {
      flatListRef.current.scrollToIndex({
        index: dataLength,
        animated: false,
      });
    }
  }, [dataLength]);

  const handleCollectionPress = (collection: Collection) => {
    router.push(`/collection/${collection.id}`);
  };

  const onScroll = (event: any) => {
    const offsetX = event.nativeEvent.contentOffset.x;
    const index = Math.round(offsetX / (TILE_WIDTH + TILE_GAP));

    if (index <= 0 || index >= dataLength * 2) {
      flatListRef.current?.scrollToIndex({
        index: dataLength,
        animated: false,
      });
    }
  };

  const renderTile = ({ item }: { item: Collection }) => (
    <TouchableOpacity
      style={styles.tile}
      onPress={() => handleCollectionPress(item)}
      activeOpacity={0.95}
    >
      <LinearGradient
        colors={[...item.gradient, item.gradient[1]]}
        start={{ x: 0, y: 0 }}
        end={{ x: 1, y: 1 }}
        style={styles.gradient}
      >
        {item.bannerUrl && (
          <Image
            source={{ uri: item.bannerUrl }}
            style={styles.bannerImage}
            resizeMode="cover"
          />
        )}
        <View style={styles.overlay}>
          <Text style={styles.title}>{item.title}</Text>
          <Text style={styles.itemsCount}>{item.itemsCount} items</Text>
        </View>
      </LinearGradient>
    </TouchableOpacity>
  );

  if (loading || collections.length === 0) {
    return null;
  }

  return (
    <View style={styles.container}>
      <FlatList
        ref={flatListRef}
        data={infiniteData}
        renderItem={renderTile}
        keyExtractor={(item, index) => `${item.id}-${index}`}
        horizontal
        showsHorizontalScrollIndicator={false}
        contentContainerStyle={styles.listContent}
        snapToInterval={TILE_WIDTH + TILE_GAP}
        decelerationRate="fast"
        snapToAlignment="center"
        onScroll={onScroll}
        scrollEventThrottle={16}
        getItemLayout={(data, index) => ({
          length: TILE_WIDTH + TILE_GAP,
          offset: (TILE_WIDTH + TILE_GAP) * index,
          index,
        })}
        ItemSeparatorComponent={() => <View style={{ width: TILE_GAP }} />}
      />
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    marginTop: 16,
    marginBottom: 8,
  },
  listContent: {
    paddingHorizontal: 32,
  },
  tile: {
    width: TILE_WIDTH,
    height: TILE_HEIGHT,
    borderRadius: 20,
    overflow: 'hidden',
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 4 },
    shadowOpacity: 0.15,
    shadowRadius: 8,
    elevation: 6,
  },
  gradient: {
    flex: 1,
    justifyContent: 'flex-end',
  },
  bannerImage: {
    ...StyleSheet.absoluteFillObject,
    opacity: 0.7,
  },
  overlay: {
    padding: 16,
    backgroundColor: 'rgba(0,0,0,0.3)',
  },
  title: {
    fontSize: 24,
    fontWeight: '700',
    color: '#fff',
    textShadowColor: 'rgba(0, 0, 0, 0.3)',
    textShadowOffset: { width: 0, height: 1 },
    textShadowRadius: 3,
  },
  itemsCount: {
    fontSize: 14,
    color: 'rgba(255,255,255,0.8)',
    marginTop: 4,
  },
});
```

#### Collection Screen (Masonry)

```typescript
// app/collection/[id].tsx

import { CollectionItem } from '@/types/models/collection';
import { collectionsApi } from '@/services/collections';
import { Ionicons } from '@expo/vector-icons';
import { router, useLocalSearchParams } from 'expo-router';
import React, { useCallback, useEffect, useState } from 'react';
import {
  ActivityIndicator,
  Dimensions,
  Image,
  ScrollView,
  StyleSheet,
  Text,
  TouchableOpacity,
  View,
} from 'react-native';

const { width: SCREEN_WIDTH } = Dimensions.get('window');
const COLUMN_GAP = 12;
const PADDING = 16;
const COLUMN_WIDTH = (SCREEN_WIDTH - PADDING * 2 - COLUMN_GAP) / 2;

export default function CollectionScreen() {
  const { id } = useLocalSearchParams<{ id: string }>();
  const [collection, setCollection] = useState<Collection | null>(null);
  const [items, setItems] = useState<CollectionItem[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadCollection();
  }, [id]);

  const loadCollection = async () => {
    if (!id) return;
    try {
      const [collectionData, itemsData] = await Promise.all([
        collectionsApi.getCollectionById(id),
        collectionsApi.getCollectionItems(id),
      ]);
      setCollection(collectionData);
      setItems(itemsData);
    } catch (error) {
      console.error('Failed to load collection:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleItemPress = (item: CollectionItem) => {
    router.push(`/collection/item/${item.id}`);
  };

  // Masonry layout calculation
  const getMasonryColumns = useCallback(() => {
    const leftColumn: CollectionItem[] = [];
    const rightColumn: CollectionItem[] = [];
    let leftHeight = 0;
    let rightHeight = 0;

    items.forEach((item) => {
      // Estimate item height (image + text)
      const aspectRatio =
        item.imageWidth && item.imageHeight
          ? item.imageHeight / item.imageWidth
          : 1.2; // fallback ratio
      const imageHeight = COLUMN_WIDTH * aspectRatio;
      const textHeight = 60;
      const itemHeight = imageHeight + textHeight;

      if (leftHeight <= rightHeight) {
        leftColumn.push(item);
        leftHeight += itemHeight + 12;
      } else {
        rightColumn.push(item);
        rightHeight += itemHeight + 12;
      }
    });

    return [leftColumn, rightColumn];
  }, [items]);

  const [leftColumn, rightColumn] = getMasonryColumns();

  const renderItem = (item: CollectionItem) => {
    const aspectRatio =
      item.imageWidth && item.imageHeight
        ? item.imageHeight / item.imageWidth
        : 1.2;
    const imageHeight = COLUMN_WIDTH * aspectRatio;

    return (
      <TouchableOpacity
        key={item.id}
        style={styles.itemCard}
        onPress={() => handleItemPress(item)}
        activeOpacity={0.8}
      >
        <Image
          source={{ uri: item.thumbnailUrl || item.imageUrl }}
          style={[styles.itemImage, { height: imageHeight }]}
          resizeMode="cover"
        />
        <View style={styles.itemInfo}>
          <Text style={styles.itemTitle} numberOfLines={2}>
            {item.title}
          </Text>
          <View style={styles.priceRow}>
            <Text style={styles.itemPrice}>
              {item.currency === 'USD' ? '$' : 'â‚½'}{item.price?.toFixed(2)}
            </Text>
            <Text style={styles.storeName}>{item.sourceName}</Text>
          </View>
        </View>
      </TouchableOpacity>
    );
  };

  if (loading) {
    return (
      <View style={styles.loadingContainer}>
        <ActivityIndicator size="large" color="#000" />
      </View>
    );
  }

  return (
    <View style={styles.container}>
      {/* Header */}
      <View style={styles.header}>
        <TouchableOpacity onPress={() => router.back()} style={styles.backButton}>
          <Ionicons name="arrow-back" size={24} color="#000" />
        </TouchableOpacity>
        <Text style={styles.headerTitle}>{collection?.title}</Text>
        <View style={styles.headerRight} />
      </View>

      {/* Banner */}
      {collection?.bannerUrl && (
        <Image
          source={{ uri: collection.bannerUrl }}
          style={styles.banner}
          resizeMode="cover"
        />
      )}

      {/* Masonry Grid */}
      <ScrollView
        style={styles.scrollView}
        contentContainerStyle={styles.scrollContent}
        showsVerticalScrollIndicator={false}
      >
        <View style={styles.masonryContainer}>
          <View style={styles.column}>
            {leftColumn.map(renderItem)}
          </View>
          <View style={styles.column}>
            {rightColumn.map(renderItem)}
          </View>
        </View>
      </ScrollView>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#000',
  },
  loadingContainer: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: '#000',
  },
  header: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
    paddingHorizontal: 16,
    paddingTop: 60,
    paddingBottom: 16,
  },
  backButton: {
    width: 40,
    height: 40,
    borderRadius: 20,
    backgroundColor: 'rgba(255,255,255,0.1)',
    justifyContent: 'center',
    alignItems: 'center',
  },
  headerTitle: {
    fontSize: 18,
    fontWeight: '600',
    color: '#fff',
  },
  headerRight: {
    width: 40,
  },
  banner: {
    width: SCREEN_WIDTH,
    height: 180,
  },
  scrollView: {
    flex: 1,
  },
  scrollContent: {
    padding: PADDING,
  },
  masonryContainer: {
    flexDirection: 'row',
    gap: COLUMN_GAP,
  },
  column: {
    flex: 1,
    gap: 12,
  },
  itemCard: {
    backgroundColor: '#fff',
    borderRadius: 12,
    overflow: 'hidden',
  },
  itemImage: {
    width: '100%',
    aspectRatio: 0.8,
  },
  itemInfo: {
    padding: 12,
  },
  itemTitle: {
    fontSize: 14,
    fontWeight: '500',
    color: '#000',
    marginBottom: 4,
  },
  priceRow: {
    flexDirection: 'row',
    alignItems: 'center',
    justifyContent: 'space-between',
  },
  itemPrice: {
    fontSize: 16,
    fontWeight: '700',
    color: '#000',
  },
  storeName: {
    fontSize: 12,
    color: '#666',
  },
});
```

### 6.3 Service Layer

```typescript
// services/collections/collectionsApi.ts

import { supabase } from '@/lib/supabase/client';
import { Collection, CollectionItem } from '@/types/models/collection';

class CollectionsApi {
  /**
   * Get all active collections for carousel
   */
  async getActiveCollections(): Promise<Collection[]> {
    const { data, error } = await supabase.rpc('get_active_collections');

    if (error) {
      console.error('[CollectionsApi] Error fetching collections:', error);
      throw error;
    }

    return (data || []).map(this.mapToCollection);
  }

  /**
   * Get collection by ID
   */
  async getCollectionById(id: string): Promise<Collection | null> {
    const { data, error } = await supabase
      .from('collections')
      .select('*')
      .eq('id', id)
      .eq('is_active', true)
      .single();

    if (error) {
      console.error('[CollectionsApi] Error fetching collection:', error);
      return null;
    }

    return this.mapToCollection(data);
  }

  /**
   * Get items for a collection with pagination
   */
  async getCollectionItems(
    collectionId: string,
    limit = 50,
    offset = 0,
  ): Promise<CollectionItem[]> {
    const { data, error } = await supabase.rpc('get_collection_items', {
      p_collection_id: collectionId,
      p_limit: limit,
      p_offset: offset,
    });

    if (error) {
      console.error('[CollectionsApi] Error fetching items:', error);
      throw error;
    }

    return (data || []).map(this.mapToCollectionItem);
  }

  /**
   * Get single collection item by ID
   */
  async getCollectionItemById(itemId: string): Promise<CollectionItem | null> {
    const { data, error } = await supabase
      .from('collection_items')
      .select(
        `
        *,
        collections!inner(is_active)
      `,
      )
      .eq('id', itemId)
      .eq('is_active', true)
      .single();

    if (error || !data?.collections?.is_active) {
      console.error('[CollectionsApi] Error fetching item:', error);
      return null;
    }

    return this.mapToCollectionItem(data);
  }

  /**
   * Add collection item to user's wardrobe
   */
  async addItemToWardrobe(item: CollectionItem, userId: string): Promise<string> {
    // CRITICAL (Obrazz offline-first): wardrobe item creation expects a LOCAL imageUri.
    // Current itemService.saveImageLocally() ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞµÑ‚ Ñ„Ğ°Ğ¹Ğ» Ñ‡ĞµÑ€ĞµĞ· expo-file-system,
    // Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ¼Ñƒ http(s) URL Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ñ‚ÑŒ Ğ½ĞµĞ»ÑŒĞ·Ñ.
    const { downloadImageFromUrl } = await import('@/services/shopping/webCaptureService');
    const { itemServiceOffline } = await import('@/services/wardrobe/itemServiceOffline');

    const localUri = await downloadImageFromUrl(item.imageUrl);

    const wardrobeItem = await itemServiceOffline.createItem({
      userId,
      title: item.title,
      category: (item.category as any) || 'other',
      colors: item.colors?.length ? item.colors.map((c) => ({ hex: c.hex })) : [{ hex: '#CCCCCC' }],
      primaryColor: item.colors?.[0] ? { hex: item.colors[0].hex } : { hex: '#CCCCCC' },
      styles: [],
      seasons: [],
      imageUri: localUri,
      price: item.price,
      metadata: {
        source: 'web',
        sourceUrl: item.sourceUrl,
        sourceName: item.sourceName,
      },
    });

    return wardrobeItem.id;
  }

  // Mappers
  private mapToCollection(data: any): Collection {
    return {
      id: data.id,
      title: data.title,
      titleEn: data.title_en,
      description: data.description,
      bannerUrl: data.banner_url,
      gradient: data.gradient || ['#667eea', '#764ba2'],
      sortOrder: data.sort_order || 0,
      isActive: data.is_active,
      itemsCount: data.items_count || 0,
      createdAt: new Date(data.created_at),
      updatedAt: new Date(data.updated_at),
    };
  }

  private mapToCollectionItem(data: any): CollectionItem {
    return {
      id: data.id,
      collectionId: data.collection_id,
      title: data.title,
      description: data.description,
      imageUrl: data.image_url,
      thumbnailUrl: data.thumbnail_url,
      imageWidth: data.image_width,
      imageHeight: data.image_height,
      sourceUrl: data.source_url,
      sourceName: data.source_name,
      price: data.price,
      currency: data.currency || 'USD',
      category: data.category,
      colors: data.colors || [],
      sortOrder: data.sort_order || 0,
      isActive: data.is_active,
      metadata: data.metadata || {},
      createdAt: new Date(data.created_at),
      updatedAt: new Date(data.updated_at),
    };
  }
}

export const collectionsApi = new CollectionsApi();
```

---

## 7. ĞŸĞ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### Phase 1: Backend Foundation (3-4 Ğ´Ğ½Ñ)

| #   | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°                                                                                     | ĞÑ†ĞµĞ½ĞºĞ° | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
| --- | ------------------------------------------------------------------------------------------ | ------ | --------- |
| 1.1 | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ SQL Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† `collections`, `collection_items`                          | 2Ñ‡     | P0        |
| 1.2 | ĞŸÑ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Supabase                                                              | 30Ğ¼    | P0        |
| 1.3 | ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ RLS (ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñƒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ SELECT Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾; Ğ±ĞµĞ· write-Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸Ğº Ğ´Ğ»Ñ authenticated) | 1Ñ‡     | P0        |
| 1.4 | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Storage bucket `collections` + policies (read=authenticated, write=service_role)   | 30Ğ¼    | P0        |
| 1.5 | ĞŸĞ¾Ğ´Ğ½ÑÑ‚ÑŒ Rails API ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº (ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñ‹, ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°, Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ)             | 4Ñ‡     | P0        |
| 1.6 | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ triggers Ğ´Ğ»Ñ `items_count` Ğ¸ `updated_at`                                         | 30Ğ¼    | P0        |
| 1.7 | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ (2-3 Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸, 10+ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²)                                        | 1Ñ‡     | P1        |

### Phase 2: Mobile App - Core Features (4-5 Ğ´Ğ½ĞµĞ¹)

| #    | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°                                                                | ĞÑ†ĞµĞ½ĞºĞ° | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
| ---- | --------------------------------------------------------------------- | ------ | --------- |
| 2.1  | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ types/models/collection.ts                                    | 30Ğ¼    | P0        |
| 2.2  | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ services/collections/collectionsApi.ts (calls Rails API)      | 2Ñ‡     | P0        |
| 2.3  | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ components/collections/CollectionsCarousel.tsx                | 3Ñ‡     | P0        |
| 2.4  | Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ StylesCarousel Ğ½Ğ° CollectionsCarousel Ğ² app/(tabs)/index.tsx | 30Ğ¼    | P0        |
| 2.5  | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ app/collection/[id].tsx (ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ Ñ masonry)         | 4Ñ‡     | P0        |
| 2.6  | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ app/collection/item/[itemId].tsx (Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°)  | 3Ñ‡     | P0        |
| 2.7  | Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ "Add to Wardrobe" Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»                              | 2Ñ‡     | P0        |
| 2.8  | Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ "Open in Store" (Linking.openURL)                         | 30Ğ¼    | P0        |
| 2.9  | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ loading states Ğ¸ error handling                              | 1Ñ‡     | P1        |
| 2.10 | Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½Ğ° ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ñ…                                           | 2Ñ‡     | P1        |

### Phase 3: Rails Admin (3-5 Ğ´Ğ½ĞµĞ¹)

| #   | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°                                                                    | ĞÑ†ĞµĞ½ĞºĞ° | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
| --- | ------------------------------------------------------------------------- | ------ | --------- |
| 3.1 | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `AdminUser` (custom + `has_secure_password`) + Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº `/admin` | 2Ñ‡     | P0        |
| 3.2 | (ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾) Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Administrate/ActiveAdmin (Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¾Ğ´Ğ¸Ğ½)          | 2Ñ‡     | P1        |
| 3.3 | CRUD Ğ´Ğ»Ñ `collections`                                                    | 3Ñ‡     | P0        |
| 3.4 | CRUD Ğ´Ğ»Ñ `collection_items`                                               | 4Ñ‡     | P0        |
| 3.5 | Upload Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ² Supabase Storage (full + thumb)                      | 4Ñ‡     | P0        |
| 3.6 | ĞĞ²Ñ‚Ğ¾-`image_width/height` + Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ thumb (job/inline)                  | 3Ñ‡     | P1        |
| 3.7 | Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Rails (Render/Railway) + ÑĞµĞºÑ€ĞµÑ‚Ñ‹ Supabase service-role             | 2Ñ‡     | P0        |

### Phase 4: Polish & Launch (2-3 Ğ´Ğ½Ñ)

| #   | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°                                                    | ĞÑ†ĞµĞ½ĞºĞ° | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
| --- | --------------------------------------------------------- | ------ | --------- |
| 4.1 | ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ ĞºĞ°Ñ€ÑƒÑĞµĞ»Ğ¸                   | 2Ñ‡     | P1        |
| 4.2 | ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² Zustand store                        | 2Ñ‡     | P2        |
| 4.3 | Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ pull-to-refresh Ğ½Ğ° ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğµ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸             | 1Ñ‡     | P2        |
| 4.4 | Ğ›Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (RU/EN) Ğ´Ğ»Ñ UI                                | 2Ñ‡     | P2        |
| 4.5 | Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ² (ĞºĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ) | 1Ñ‡     | P1        |
| 4.6 | ĞĞ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼ (Ğ¼Ğ¸Ğ½Ğ¸Ğ¼ÑƒĞ¼ 5 Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº Ğ¿Ğ¾ 15+ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ²)  | 4Ñ‡     | P1        |
| 4.7 | Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ                                    | 2Ñ‡     | P0        |

### Phase 5: ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ (+2-5 Ğ´Ğ½ĞµĞ¹)

| #   | Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°                                                 | ĞÑ†ĞµĞ½ĞºĞ° |
| --- | ------------------------------------------------------ | ------ |
| 5.1 | ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Rails API (Redis)                          | 3Ñ‡     |
| 5.2 | ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (view/open/add) + Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ñ‹ Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ   | 4Ñ‡     |
| 5.3 | Bulk import (CSV) Ğ² Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ                            | 4Ñ‡     |
| 5.4 | ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑÑ‹Ğ»Ğ¾Ğº/Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ° (Sidekiq scheduled job) | 4Ñ‡     |

---

## 8. API Reference (Rails)

### 8.1 Public API Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```
GET  /api/v1/collections
GET  /api/v1/collections/:id
GET  /api/v1/collections/:id/items?limit=20&cursor=...
GET  /api/v1/collection_items/:id

# (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾, ĞµÑĞ»Ğ¸ Ğ´ĞµĞ»Ğ°ĞµĞ¼ Ğ°Ğ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºÑƒ ÑƒĞ¶Ğµ Ğ² MVP)
POST /api/v1/collections/events
```

### 8.2 ĞŸÑ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ğ¾Ğ²

- API Ğ¾Ñ‚Ğ´Ğ°Ñ‘Ñ‚ **camelCase** Ğ¿Ğ¾Ğ»Ñ (ĞºĞ°Ğº Ğ¿Ñ€Ğ¸Ğ½ÑÑ‚Ğ¾ Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸)
- Rails Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ñ‚ snake_case Supabase â†’ camelCase
- Ğ’ API Ğ½Ğµ Ğ¾Ñ‚Ğ´Ğ°Ñ‘Ğ¼ â€œÑ‡ĞµÑ€Ğ½Ğ¾Ğ²Ğ¸ĞºĞ¸â€: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ `isActive=true`

---

## 9. UI/UX ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸

### 9.1 ĞšĞ°Ñ€ÑƒÑĞµĞ»ÑŒ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº (Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ)

- **Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¿Ğ»Ğ¸Ñ‚ĞºĞ¸:** `SCREEN_WIDTH - 64px` Ã— `160px`
- **Border radius:** `20px`
- **Spacing:** `16px` Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ»Ğ¸Ñ‚ĞºĞ°Ğ¼Ğ¸
- **Padding:** `32px` Ğ¿Ğ¾ ĞºÑ€Ğ°ÑĞ¼
- **Snap:** Ğš Ñ†ĞµĞ½Ñ‚Ñ€Ñƒ, decelerationRate="fast"
- **Infinite scroll:** Ğ”Ğ° (3x data duplication)
- **Gradient overlay:** Ğ¡Ğ½Ğ¸Ğ·Ñƒ, Ğ´Ğ»Ñ Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼Ğ¾ÑÑ‚Ğ¸ Ñ‚ĞµĞºÑÑ‚Ğ°
- **Typography:**
  - Title: 24px, bold, white, shadow
  - Items count: 14px, white 80% opacity

### 9.2 Masonry Grid (Ğ¡Ñ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸)

- **Columns:** 2
- **Gap:** `12px`
- **Padding:** `16px`
- **Card background:** `#FFFFFF`
- **Card border-radius:** `12px`
- **Image aspect ratio:** ~0.8 (Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğµ)
- **Typography:**
  - Title: 14px, medium, 2 lines max
  - Price: 16px, bold
  - Store: 12px, gray

### 9.3 Item Detail Screen

- **Layout:** ĞŸĞ¾Ñ…Ğ¾Ğ¶ Ğ½Ğ° ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ `app/item/[id].tsx`
- **Image:** Fullscreen Ñ overlay buttons
- **Actions:**
  - "Add to Wardrobe" â€” primary button, blue
  - "Open in Store" â€” secondary button, outline
- **Info cards:**
  - Price + Store
  - Category (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
  - Brand (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)

---

## 10. ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### 10.1 ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹

- Ğ”Ğ»Ñ Masonry Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ `thumbnail_url` (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ), Ğ° `image_url` â€” Ğ½Ğ° detail
- ĞĞ° Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞ¹: full + thumb + `image_width`/`image_height`
- ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ğ¾Ğ·Ğ¶Ğµ: `expo-image` Ğ´Ğ»Ñ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ (Ğ½Ğµ Ğ±Ğ»Ğ¾ĞºĞµÑ€ Ğ´Ğ»Ñ MVP)

### 10.2 Offline Support

- ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸ â€” **online-first** (Ğ±ĞµĞ· Ğ¾Ñ‡ĞµÑ€ĞµĞ´ĞµĞ¹ Ğ½Ğ° Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ)
- Ğ”Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ³Ğ¾ UX Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ĞºÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğ¹ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚ (read-only) Ğ¸ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ ĞµĞ³Ğ¾ offline + Ğ±Ğ°Ğ½Ğ½ĞµÑ€ â€œĞ½ĞµÑ‚ ÑĞµÑ‚Ğ¸â€

### 10.3 Analytics (Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞµ)

Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ:

- `collection_viewed` â€” Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€ĞºĞ¸
- `collection_item_viewed` â€” Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ°
- `collection_item_added` â€” Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ² Ğ³Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±
- `collection_item_opened` â€” Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´ Ğ½Ğ° ÑĞ°Ğ¹Ñ‚ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ°

### 10.4 Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

- ĞĞ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ ĞºĞ»Ğ°Ğ´Ñ‘Ğ¼ `SUPABASE_SERVICE_ROLE_KEY` Ğ² Ğ¼Ğ¾Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
- Ğ’ÑĞµ write-Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ (ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ/Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ´Ğ±Ğ¾Ñ€Ğ¾Ğº, Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹) â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ server-side (Rails)
- RLS Ğ² Supabase Ğ´ĞµĞ»Ğ°ĞµĞ¼ Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ğ¼:
  - ĞºĞ»Ğ¸ĞµĞ½Ñ‚Ñƒ Ğ½ÑƒĞ¶ĞµĞ½ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ `SELECT` Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾
  - write-Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ `authenticated` Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹ (Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ privilege escalation)
  - ÑĞµÑ€Ğ²ĞµÑ€ Ğ¿Ğ¸ÑˆĞµÑ‚ Ñ‡ĞµÑ€ĞµĞ· service-role (Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ñ‚ RLS)

---

## 11. Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ³Ğ¾ ĞºĞ¾Ğ´Ğ°

### Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹:

- `GlassBackButton`, `GlassIconButton` â€” Ğ¸Ğ· `@components/ui/glass`
- `MasonryGallery` (Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾) â€” Ğ¸Ğ· `@components/shopping` (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ)
- `itemService.createItem()` â€” Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ² Ğ³Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±

### ĞŸĞ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹:

- Service layer: `collectionsApi` ÑĞ»ĞµĞ´ÑƒĞµÑ‚ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñƒ `itemService`, Ğ½Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ Ğº Rails API
- Type mapping: snake_case (DB) â†’ camelCase (App)
- Navigation: Expo Router Ñ dynamic routes

---

**Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸!** ğŸš€

ĞĞ°Ñ‡Ğ¸Ğ½Ğ°Ñ‚ÑŒ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒÑ Ñ Phase 1 (Rails API + Supabase schema) + Phase 2 (Mobile Core), Ğ·Ğ°Ñ‚ĞµĞ¼ Phase 3 (Rails Admin) Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼.
