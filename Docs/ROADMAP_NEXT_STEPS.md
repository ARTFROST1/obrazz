# ğŸš€ Obrazz â€” Roadmap & Next Steps

> **Ğ”Ğ°Ñ‚Ğ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ:** 27 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026  
> **ĞĞ²Ñ‚Ğ¾Ñ€:** AI Assistant (Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ ĞºĞ¾Ğ´Ğ°)  
> **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** Stage 4.13 Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ (Navigation Refactor + Expo SDK 55 migration). Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ¿: Stage 5 (AI).

---

## ğŸ†• ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚: Rails Backend Implementation Plan

> **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½:** 27 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026  
> **ĞŸÑƒÑ‚ÑŒ:** [RAILS_BACKEND_IMPLEMENTATION_PLAN.md](./RAILS_BACKEND_IMPLEMENTATION_PLAN.md)

ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ruby on Rails backend Ñ:

- **Solid Queue** Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Redis/Sidekiq (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½Ğ° Render Free Tier)
- AI-Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ (The New Black API)
- Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ² Ğ¸ Ğ±Ğ¸Ğ»Ğ»Ğ¸Ğ½Ğ³ (YooKassa + IAP)
- Ğ›Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ±Ğ¸Ğ½ĞµÑ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Hotwire + Tailwind)
- ĞĞ´Ğ¼Ğ¸Ğ½-Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (Administrate)

---

## ğŸ“Š Executive Summary

Obrazz Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ½Ğ° ĞºĞ»ÑÑ‡ĞµĞ²Ğ¾Ğ¼ ÑÑ‚Ğ°Ğ¿Ğµ Ñ€Ğ°Ğ·Ğ²Ğ¸Ñ‚Ğ¸Ñ. **Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½** (Stage 1-4.12):

- âœ… ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ (Supabase Auth)
- âœ… Ğ“Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ± Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ Ğ²ĞµÑ‰ĞµĞ¹, ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸ĞµĞ¼ Ñ„Ğ¾Ğ½Ğ° (Pixian.ai), Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹
- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ² Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ (2-step flow, canvas, gestures, undo/redo)
- âœ… Shopping Browser (Web Capture) â€” Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²ĞµÑ‰ĞµĞ¹ Ğ¸Ğ· Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚-Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¾Ğ²
- âœ… Offline-first Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° â€” Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ, Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

**ğŸ¯ Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚:** Stage 5 â€” AI-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ (Ñ‡ĞµÑ€ĞµĞ· Rails proxy)

**Ğ‘Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğµ ÑÑ‚Ğ°Ğ¿Ñ‹:**

1. âœ… **Stage 4.13: Navigation Refactor** â€” Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ğ“Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±Ğ° Ğ¸ ĞĞ±Ñ€Ğ°Ğ·Ğ¾Ğ², ĞºĞ½Ğ¾Ğ¿ĞºĞ° "+" (Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾)
2. **Stage 5: AI-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸** â€” Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ The New Black API
3. **Stage 6: Rails Backend** â€” Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸, Ñ‚Ğ¾ĞºĞµĞ½Ñ‹, AI proxy
4. **Stage 7: ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ¸** â€” IAP + Ğ²ĞµĞ±-Ğ±Ğ¸Ğ»Ğ»Ğ¸Ğ½Ğ³

---

## ğŸ“‹ ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

1. [Ğ§Ñ‚Ğ¾ ÑƒĞ¶Ğµ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾](#Ñ‡Ñ‚Ğ¾-ÑƒĞ¶Ğµ-ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾-stage-1-412)
2. [Ğ§Ñ‚Ğ¾ ĞµÑ‰Ñ‘ Ğ½Ğµ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾](#Ñ‡Ñ‚Ğ¾-ĞµÑ‰Ñ‘-Ğ½Ğµ-ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾)
3. [Ğ‘Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğµ ÑˆĞ°Ğ³Ğ¸](#Ğ±Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğµ-ÑˆĞ°Ğ³Ğ¸-Ñ‡Ñ‚Ğ¾-Ğ´ĞµĞ»Ğ°ĞµĞ¼-ÑĞµĞ¹Ñ‡Ğ°Ñ)
4. [Navigation Refactor (Stage 4.13)](#navigation-refactor-stage-413)
5. [AI-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ĞºĞ°](#ai-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸-Ğ¸-Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ĞºĞ°-Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²)
6. [ĞĞ½Ğ°Ğ»Ğ¸Ğ· Backend ÑÑ‚ĞµĞºĞ°](#Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·-backend-ÑÑ‚ĞµĞºĞ°)
7. [ĞĞ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ iOS](#Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸-ios)
8. [ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°](#Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ½Ğ°Ñ-ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°)
9. [Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°](#Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ-Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…-Ğ¸-Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°)
10. [Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Roadmap Ğ¿Ğ¾ ÑÑ‚Ğ°Ğ´Ğ¸ÑĞ¼](#Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹-roadmap-Ğ¿Ğ¾-ÑÑ‚Ğ°Ğ´Ğ¸ÑĞ¼)

---

## âœ… Ğ§Ñ‚Ğ¾ ÑƒĞ¶Ğµ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾ (Stage 1-4.12)

### Stage 1: Foundation & Setup âœ…

- Expo SDK 55 (preview) + React Native 0.83.1 + TypeScript
- Supabase Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ (PostgreSQL + Auth + Storage)
- Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ°Ğ¿Ğ¾Ğº, Ğ°Ğ»Ğ¸Ğ°ÑÑ‹ Ğ¿ÑƒÑ‚ĞµĞ¹ (@components, @services, @store)
- ESLint, Prettier, Husky pre-commit hooks
- Zustand stores Ñ persistence, TanStack Query

### Stage 2: Authentication âœ…

- Email Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ/Ğ²Ñ…Ğ¾Ğ´ Ñ‡ĞµÑ€ĞµĞ· Supabase Auth
- JWT Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ Ñ auto-refresh
- Protected routes (isAuthenticated check)
- Ğ­ĞºÑ€Ğ°Ğ½ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ñ logout

### Stage 3: Wardrobe Management âœ…

- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²ĞµÑ‰ĞµĞ¹ Ğ¸Ğ· ĞºĞ°Ğ¼ĞµÑ€Ñ‹/Ğ³Ğ°Ğ»ĞµÑ€ĞµĞ¸
- ImageCropper Ñ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€ĞµĞ·ĞºĞ¾Ğ¹ 3:4
- Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ğ½Ğ° Ñ‡ĞµÑ€ĞµĞ· Pixian.ai API
- ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸, Ñ†Ğ²ĞµÑ‚Ğ°, ÑÑ‚Ğ¸Ğ»Ğ¸, ÑĞµĞ·Ğ¾Ğ½Ñ‹
- Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¸ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°
- Default Items (24 Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ñ… Ğ²ĞµÑ‰Ğ¸ Ğ´Ğ»Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹)
- Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ (expo-file-system)

### Stage 4: Outfit Creator âœ…

- 2-step flow: Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ²ĞµÑ‰ĞµĞ¹ â†’ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ½Ğ° canvas
- 4-Tab ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° (Basic, Dress, All, Custom)
- SmoothCarousel Ñ Ñ€ĞµĞ°Ğ»Ğ¸ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğ¹ Ñ„Ğ¸Ğ·Ğ¸ĞºĞ¾Ğ¹
- Drag & drop, Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ, Ğ¿Ğ¾Ğ²Ğ¾Ñ€Ğ¾Ñ‚ (gesture-handler + reanimated)
- Undo/Redo Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ/Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²
- canvasSettings Ğ´Ğ»Ñ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸ edit mode

### Stage 4.7-4.10: Shopping Browser âœ…

- Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€ Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚-Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¾Ğ²
- Shopping Stories ĞºĞ°Ñ€ÑƒÑĞµĞ»ÑŒ Ğ½Ğ° Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğ¹
- ĞĞ²Ñ‚Ğ¾Ğ´ĞµÑ‚ĞµĞºÑ‚ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ Ğ¾Ğ´ĞµĞ¶Ğ´Ñ‹ Ğ½Ğ° ÑĞ°Ğ¹Ñ‚Ğµ
- ĞĞ´Ğ¸Ğ½ Ñ‚Ğ°Ğ¿ Ğ´Ğ»Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ² Ğ³Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±

### Stage 4.12: Offline-First Architecture âœ…

- ĞœĞ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¸Ğ· Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ĞºĞµÑˆĞ°
- CRUD Ğ±ĞµĞ· Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚Ğ°
- ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ (sync queue)
- Ğ¤Ğ¾Ğ½Ğ¾Ğ²Ğ°Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- Optimistic UI

---

## âŒ Ğ§Ñ‚Ğ¾ ĞµÑ‰Ñ‘ Ğ½Ğµ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾

### Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ (Core Ğ´Ğ»Ñ MVP/Ñ€ĞµĞ»Ğ¸Ğ·Ğ°):

| Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ                    | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ            | Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸  |
| -------------------------- | ----------------- | ------------ |
| **Navigation Refactor**    | ğŸš§ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑÑ‚Ğ°Ğ¿ | â€”            |
| **Rails Backend**          | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | Nav Refactor |
| **AI Virtual Try-On**      | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | Backend      |
| **AI Fashion Models**      | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | Backend      |
| **Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ²**        | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | Backend      |
| **ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸ (IAP)**         | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | Backend      |
| **Ğ’ĞµĞ±-Ğ±Ğ¸Ğ»Ğ»Ğ¸Ğ½Ğ³ (YooMoney)** | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | Backend      |
| **Onboarding**             | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | â€”            |
| **Paywall**                | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾      | ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸     |

### Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ (Should-have):

| Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ                             | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ             | Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸       |
| ----------------------------------- | ------------------ | ----------------- |
| **Push-ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ**                | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾       | Backend           |
| **Apple Vision (ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ğ½Ğ°)**    | ğŸ“‹ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ | Development build |
| **ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ñ‹Ğµ Ğ¼ĞµĞ½Ñ iOS (UIMenu)**   | ğŸ“‹ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ | Development build |
| **Ğ“ĞµĞ¹Ğ¼Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ (streak)**           | ğŸ“‹ ĞĞµ Ğ½Ğ°Ñ‡Ğ°Ñ‚Ğ¾       | Backend           |
| **Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ² ĞºĞ°Ğº Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ** | ğŸ“‹ ĞÑ‚Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¾        | â€”                 |

### ĞĞ¸Ğ·ĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ (Nice-to-have):

| Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ                          | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ              |
| -------------------------------- | ------------------- |
| Ğ ĞµĞºĞ»Ğ°Ğ¼Ğ° (VK Ads, Ğ Ğ¡Ğ¯, AdMob)     | ğŸ“‹ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ      |
| Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ Ğ»Ğ¾ĞºĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ          | ğŸ“‹ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° |
| Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²Ğ°Ğ¼Ğ¸ | ğŸ“‹ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ      |
| Clothing Variations (AI)         | ğŸ“‹ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ      |

---

## ğŸ¯ Ğ‘Ğ»Ğ¸Ğ¶Ğ°Ğ¹ÑˆĞ¸Ğµ ÑˆĞ°Ğ³Ğ¸ (Ñ‡Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµĞ¼ ÑĞµĞ¹Ñ‡Ğ°Ñ)

### ğŸ¯ Ğ­Ñ‚Ğ°Ğ¿ C: Navigation Refactor (Stage 4.13) â€” âœ… Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•Ğ

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•Ğ**  
**Timeline:** Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾ (ÑĞ½Ğ²Ğ°Ñ€ÑŒ 2026)  
**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:** [NAVIGATION_REFACTOR_PLAN.md](./Features/NAVIGATION_REFACTOR_PLAN.md)

**Ğ¦ĞµĞ»ÑŒ:** Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

#### Ğ§Ñ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾:

**1. Bottom Navigation: 4 â†’ 3 Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸ + ĞºĞ½Ğ¾Ğ¿ĞºĞ° "+"**

```
Ğ‘Ğ«Ğ›Ğ:                          Ğ¡Ğ¢ĞĞĞ•Ğ¢:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ Home â”‚ Ward â”‚ Out â”‚ Prof â”‚   â”‚ Home â”‚ Library â”‚ Prof â”‚   +  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
```

**2. Library Screen (Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½Ñ‘Ğ½Ğ½Ñ‹Ğ¹):**

- Ğ’ĞµÑ€Ñ…Ğ½Ğ¸Ğµ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ¸: **Ğ“Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±** (ÑĞ²ĞµÑ‚Ğ»Ğ°Ñ) â†” **ĞĞ±Ñ€Ğ°Ğ·Ñ‹** (Ñ‚Ñ‘Ğ¼Ğ½Ğ°Ñ)
- ĞŸĞ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ ÑĞ¼ĞµĞ½Ñ‹ Ñ‚ĞµĞ¼Ñ‹ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ (300ms)
- ĞĞ±Ñ‰Ğ¸Ğ¹ header Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ¾Ğ¼ Ğ¸ Ğ¼ĞµĞ½Ñ

**3. ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ğ°Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ° "+":**

| Ğ­ĞºÑ€Ğ°Ğ½              | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ                              |
| ------------------ | ------------------------------------- |
| Home               | Ğ Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¼ĞµĞ½Ñ AI-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹ (4 Ğ¾Ğ¿Ñ†Ğ¸Ğ¸)  |
| Library / Ğ“Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ± | ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²ĞµÑ‰Ğ¸             |
| Library / ĞĞ±Ñ€Ğ°Ğ·Ñ‹   | ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ°             |
| Profile            | ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ (Ğ¸ĞºĞ¾Ğ½ĞºĞ° Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ) |

**5. Ğ¡ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ TabBar Ğ½Ğ° Add ÑĞºÑ€Ğ°Ğ½Ğµ:**

- Add screen Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ±ĞµĞ· Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ TabBar.
- iOS: Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ `NativeTabs hidden` (Expo SDK 55)
- Android: `tabBarStyle` â†’ `{ display: 'none' }`

**4. AI-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ½Ğ° Home (placeholder):**

ĞŸÑ€Ğ¸ Ğ½Ğ°Ğ¶Ğ°Ñ‚Ğ¸Ğ¸ "+" Ğ½Ğ° Home Ñ€Ğ°ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¼ĞµĞ½Ñ:

- ğŸ‘— Virtual Try-On â€” Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ²ĞµÑ‰ÑŒ Ğ½Ğ° Ñ„Ğ¾Ñ‚Ğ¾
- ğŸ§ AI Fashion Model â€” Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ğ² Ğ²ĞµÑ‰Ğ°Ñ…
- ğŸ¨ Clothing Variations â€” Ğ²Ğ°Ñ€Ğ¸Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ¸Ğ·Ğ°Ğ¹Ğ½Ğ°
- âœï¸ Edit Photo â€” Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ¾Ğ´ĞµĞ¶Ğ´Ñƒ

#### Ğ­Ñ‚Ğ°Ğ¿Ñ‹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:

- [x] **Ğ­Ñ‚Ğ°Ğ¿ C.1:** ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
- [x] **Ğ­Ñ‚Ğ°Ğ¿ C.2:** Bottom Navigation Ñ "+"
- [x] **Ğ­Ñ‚Ğ°Ğ¿ C.3:** Library Screen Ñ Ğ²ĞºĞ»Ğ°Ğ´ĞºĞ°Ğ¼Ğ¸
- [x] **Ğ­Ñ‚Ğ°Ğ¿ C.4:** ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ğ¾Ğµ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ "+"
- [x] **Ğ­Ñ‚Ğ°Ğ¿ C.5:** ĞŸĞ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

---

### Ğ­Ñ‚Ğ°Ğ¿ A: Development Build Ğ´Ğ»Ñ iOS (1-2 Ğ´Ğ½Ñ) âœ…

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•Ğ** (26 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026)

**Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾:**

- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½ development build (`npx expo prebuild -p ios`)
- âœ… Ğ Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:** [iOS_OnDevice_Background_Removal.md](./Features/iOS_OnDevice_Background_Removal.md)

---

### Ğ­Ñ‚Ğ°Ğ¿ B: Apple Vision Background Removal (3-5 Ğ´Ğ½ĞµĞ¹) âœ…

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•Ğ** (26 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026)

**Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾:**

- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½ Expo Native Module `subject-lifter`
- âœ… Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½ Swift ĞºĞ¾Ğ´ Ğ´Ğ»Ñ Apple Vision (Vision.framework) (SubjectLifterModule + SubjectLifterService)
- âœ… Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² `backgroundRemoverService` Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ fallback
- âœ… ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ UI Ğ² `add-item.tsx` Ñ Ğ¸Ğ½Ğ´Ğ¸ĞºĞ°Ñ†Ğ¸ĞµĞ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ°
- âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾ĞµĞ½ `app.config.js` (iOS deployment target 16.0)

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**

- âš¡ Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ: 0.5-2 ÑĞµĞº (Ğ±Ñ‹Ğ»Ğ¾ 2-10 ÑĞµĞº)
- ğŸ†“ Ğ‘ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾ Ğ´Ğ»Ñ iOS 16+ (ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ ~$0.02 Ğ·Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ)
- ğŸ“± Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½
- ğŸ”„ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ fallback Ğ½Ğ° Pixian Ğ´Ğ»Ñ Android/ÑÑ‚Ğ°Ñ€Ñ‹Ñ… iOS

**Ğ—Ğ°Ñ‡ĞµĞ¼:**

- Pixian.ai Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ½ĞµÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ² Ğ Ğ¤ (Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸) âœ… Ğ ĞµÑˆĞµĞ½Ğ¾
- Apple Vision â€” Ğ±ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾ Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½ âœ… Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾
- Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ: 0.5-2 ÑĞµĞº Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ vs 2-10 ÑĞµĞº Ñ‡ĞµÑ€ĞµĞ· API âœ… Ğ”Ğ¾ÑÑ‚Ğ¸Ğ³Ğ½ÑƒÑ‚Ğ¾

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:**

- [iOS On-Device Background Removal](./Features/iOS_OnDevice_Background_Removal.md) - ĞĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ¸ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ (Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Simulator)
- [Module README](../modules/subject-lifter/README.md) - Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ

**Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ (Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾):**

```
modules/
â””â”€â”€ subject-lifter/
    â”œâ”€â”€ ios/
    â”‚   â”œâ”€â”€ SubjectLifterModule.swift      # Expo module definition
    â”‚   â”œâ”€â”€ SubjectLifterService.swift     # Apple Vision (Vision.framework) logic
    â”‚   â””â”€â”€ ImageUtils.swift               # Image helpers
    â”œâ”€â”€ android/
    â”‚   â””â”€â”€ (placeholder â€” Ğ¿Ğ¾ĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Pixian)
    â”œâ”€â”€ src/
    â”‚   â””â”€â”€ index.ts                       # JS interface
    â””â”€â”€ expo-module.config.json
```

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:**

```typescript
// services/wardrobe/backgroundRemover.ts
import { SubjectLifter } from 'subject-lifter';

async removeBackground(imageUri: string): Promise<string> {
  if (Platform.OS === 'ios' && (await SubjectLifter.isAvailable())) {
    // Ğ‘ĞµÑĞ¿Ğ»Ğ°Ñ‚Ğ½Ğ¾, Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½, Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾
    return await SubjectLifter.liftSubject(imageUri);
  }

  // Fallback Ğ½Ğ° Pixian.ai Ğ´Ğ»Ñ Android Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‹Ñ… iOS
  return await this.removeBackgroundViaPixian(imageUri);
}
```

---

### Ğ­Ñ‚Ğ°Ğ¿ C: Rails Backend Foundation (1-2 Ğ½ĞµĞ´ĞµĞ»Ğ¸)

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Rails:**

- Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° (convention over configuration)
- ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ»Ñ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ (pay gem, yookassa, stripe)
- Hotwire Ğ´Ğ»Ñ dashboard Ğ±ĞµĞ· Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾ SPA
- Sidekiq Ğ´Ğ»Ñ background jobs (AI Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ)
- Ğ—Ñ€ĞµĞ»Ñ‹Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ±Ğ¸Ğ»Ğ»Ğ¸Ğ½Ğ³Ğ° Ğ¸ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¸

**ĞĞ¾ ĞµÑÑ‚ÑŒ Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ñ‹** (ÑĞ¼. Ñ€Ğ°Ğ·Ğ´ĞµĞ» "ĞĞ½Ğ°Ğ»Ğ¸Ğ· Backend ÑÑ‚ĞµĞºĞ°" Ğ½Ğ¸Ğ¶Ğµ).

**ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ MVP Backend:**

```ruby
# ĞœĞ¾Ğ´ĞµĞ»Ğ¸
User           # sync Ñ Supabase Auth (supabase_id, email)
Subscription   # plan: free/pro/max, status, provider, expires_at
TokenBalance   # purchased, subscription_tokens
TokenTransaction # spend, purchase, refund, subscription_grant
AiGeneration   # type, status, input_data, result_url

# Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹
Supabase::AuthService    # JWT validation
Supabase::SyncService    # Upload to Storage, signed URLs
TheNewBlack::Client      # HTTP client Ğº AI API
TheNewBlack::VirtualTryon, FashionModels, Variations
Tokens::BalanceService   # Check/spend tokens
Payments::YookassaService, IapService
```

---

## ğŸ”§ ĞĞ½Ğ°Ğ»Ğ¸Ğ· Backend ÑÑ‚ĞµĞºĞ°

### Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ğ»Ğ°Ğ½: Ruby on Rails 7.x

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**

- âœ… Ğ‘Ñ‹ÑÑ‚Ñ€Ğ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° fullstack (API + Dashboard)
- âœ… Hotwire/Turbo â€” ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ frontend Ğ±ĞµĞ· SPA
- âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ gems Ğ´Ğ»Ñ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ (pay, stripe, yookassa)
- âœ… Sidekiq Ğ´Ğ»Ñ background jobs
- âœ… ActiveAdmin/Administrate Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¸
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ½Ñ‹Ğ¹ ÑÑ‚ĞµĞº Ğ´Ğ»Ñ SaaS

**ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:**

- âš ï¸ Ruby Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ Ğ¼ĞµĞ½ĞµĞµ Ñ€Ğ°ÑĞ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ñ‹
- âš ï¸ ĞŸĞ¾Ñ‚Ñ€ĞµĞ±Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ²Ñ‹ÑˆĞµ Ñ‡ĞµĞ¼ Ñƒ Node.js
- âš ï¸ ĞĞ° free tier Render Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğ¼

### ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° 1: Node.js (Express/Fastify/NestJS)

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**

- âœ… Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº Ñ frontend (TypeScript)
- âœ… ĞœĞµĞ½ÑŒÑˆĞµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸, Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ cold start
- âœ… ĞĞ³Ñ€Ğ¾Ğ¼Ğ½Ğ°Ñ ÑĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° npm
- âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ Ğ´Ğ»Ñ serverless

**ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:**

- âš ï¸ ĞĞµÑ‚ "rails-like" convention over configuration
- âš ï¸ ĞŸĞ»Ğ°Ñ‚Ñ‘Ğ¶Ğ½Ñ‹Ğµ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ¸ Ğ¼ĞµĞ½ĞµĞµ Ğ·Ñ€ĞµĞ»Ñ‹Ğµ
- âš ï¸ Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ boilerplate Ğ´Ğ»Ñ Ñ‚Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡

### ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° 2: Python (FastAPI/Django)

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**

- âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾ Ğ´Ğ»Ñ AI/ML Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¹
- âœ… FastAPI â€” ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ async API
- âœ… Django â€” Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ñ‹Ğ¹ fullstack

**ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:**

- âš ï¸ Django Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ Rails Ğ² Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ Ğ´Ğ»Ñ SaaS
- âš ï¸ FastAPI Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ´Ğ»Ñ dashboard

### ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° 3: Supabase Edge Functions (Deno)

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**

- âœ… Ğ£Ğ¶Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Supabase
- âœ… Serverless, Ğ¿Ğ»Ğ°Ñ‚Ğ¸ÑˆÑŒ Ğ·Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- âœ… Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹

**ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¸:**

- âš ï¸ ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¹ runtime (Deno)
- âš ï¸ Ğ¡Ğ»Ğ¾Ğ¶Ğ½ĞµĞµ Ğ´Ğ»Ñ background jobs
- âš ï¸ ĞĞµÑ‚ dashboard Ğ¸Ğ· ĞºĞ¾Ñ€Ğ¾Ğ±ĞºĞ¸

---

### ğŸ† Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Backend

**Ğ”Ğ»Ñ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° Rails Ğ¾ÑÑ‚Ğ°Ñ‘Ñ‚ÑÑ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼:**

1. **ĞÑƒĞ¶ĞµĞ½ Dashboard** (Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ±Ğ¸Ğ½ĞµÑ‚) â€” Rails + Hotwire Ğ¸Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¾
2. **ĞÑƒĞ¶Ğ½Ñ‹ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ¸** â€” Ruby gems ÑĞ°Ğ¼Ñ‹Ğµ Ğ·Ñ€ĞµĞ»Ñ‹Ğµ
3. **ĞÑƒĞ¶Ğ½Ñ‹ background jobs** â€” Sidekiq Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½ Ğ³Ğ¾Ğ´Ğ°Ğ¼Ğ¸
4. **AI Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ°Ñ** â€” HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº The New Black, Rails ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑÑ

**Ğ¥Ğ¾ÑÑ‚Ğ¸Ğ½Ğ³:**

| ĞŸĞ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°       | Free Tier                | Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ          |
| --------------- | ------------------------ | --------------------- |
| **Render**      | 750 Ñ‡Ğ°ÑĞ¾Ğ²/Ğ¼ĞµÑ, spin-down | âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾ Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° |
| **Railway**     | $5 credit/Ğ¼ĞµÑ            | âœ… ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹     |
| **Fly.io**      | 3 shared VMs             | âœ… Edge deployment    |
| **Heroku**      | ĞĞµÑ‚ free tier            | âš ï¸ Ğ”Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ´Ğ»Ñ MVP     |
| **VPS + Kamal** | ~$5/Ğ¼ĞµÑ (Hetzner)        | âœ… ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ    |

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ñ **Render free tier**, Ğ¿Ğ¾Ğ·Ğ¶Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ° VPS + Kamal Ğ´Ğ»Ñ production.

---

## ğŸ¤– AI-Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° AI Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AI GENERATION FLOW                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Mobile App                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚  1. User uploads photo + selects outfit/item                           â”‚
â”‚  2. POST /api/v1/ai/virtual_tryon { model_photo, clothing_photo }      â”‚
â”‚  3. Receive { generationId, status: "processing" }                     â”‚
â”‚  4. Poll GET /api/v1/ai/generations/:id until completed                â”‚
â”‚  5. Display resultUrl                                                   â”‚
â”‚                                                                         â”‚
â”‚  Rails Backend                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  1. Validate JWT (Supabase Auth)                                       â”‚
â”‚  2. Check token balance (can_generate?)                                â”‚
â”‚  3. Create AiGeneration record (status: pending)                       â”‚
â”‚  4. Enqueue ProcessAiGenerationJob                                     â”‚
â”‚                                                                         â”‚
â”‚  Sidekiq Job                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  1. Spend tokens (idempotent via token_transaction_id)                 â”‚
â”‚  2. Upload user images to temporary public URLs (Supabase signed)      â”‚
â”‚  3. Call The New Black API                                             â”‚
â”‚  4. Download result (TNB deletes in 48h!)                              â”‚
â”‚  5. Save to Supabase Storage                                           â”‚
â”‚  6. Update AiGeneration (status: completed, result_url)                â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### UI/UX Ğ´Ğ»Ñ AI-Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ĞºĞ¸

**Ğ­ĞºÑ€Ğ°Ğ½ "AI Try-On" (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ĞºĞ° Ğ½Ğ° Ñ„Ğ¾Ñ‚Ğ¾):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† AI Try-On                      â“˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚      [Tap to add your photo]   â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚         ğŸ“· or ğŸ–¼ï¸              â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  Select from wardrobe:                  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ğŸ‘—  â”‚ â”‚ ğŸ‘”  â”‚ â”‚ ğŸ‘–  â”‚ â”‚ ğŸ‘Ÿ  â”‚ â†’    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                         â”‚
â”‚  OR select saved outfit:                â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ğŸ¨  â”‚ â”‚ ğŸ¨  â”‚ â”‚ ğŸ¨  â”‚ â†’            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         ğŸª„ Try On               â”‚   â”‚
â”‚  â”‚           (1 token)             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  Tokens: 15 remaining                   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ­ĞºÑ€Ğ°Ğ½ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ (loading):**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚           âœ¨ Creating magic...          â”‚
â”‚                                         â”‚
â”‚         [Animated progress ring]        â”‚
â”‚                                         â”‚
â”‚     This usually takes 10-30 seconds    â”‚
â”‚                                         â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                         â”‚
â”‚     Did you know?                       â”‚
â”‚     AI analyzes your photo and          â”‚
â”‚     realistically places the clothes    â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ­ĞºÑ€Ğ°Ğ½ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Result                    ğŸ’¾  ğŸ“¤    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚    [Generated try-on image]    â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â”‚                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Try another â”‚  â”‚ Save to album â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚       Share to Instagram        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ´Ğ»Ñ AI

```
app/
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ try-on.tsx           # AI Try-On screen
â”‚   â”œâ”€â”€ fashion-model.tsx    # AI Fashion Model screen
â”‚   â””â”€â”€ result/[id].tsx      # Generation result screen

components/
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ PhotoUploader.tsx    # Upload/capture photo
â”‚   â”œâ”€â”€ ItemSelector.tsx     # Select item/outfit
â”‚   â”œâ”€â”€ GenerationLoader.tsx # Loading animation
â”‚   â””â”€â”€ ResultView.tsx       # Display result

services/
â”œâ”€â”€ ai/
â”‚   â”œâ”€â”€ aiService.ts         # API calls to Rails backend
â”‚   â””â”€â”€ types.ts             # AI-related types

store/
â”œâ”€â”€ ai/
â”‚   â””â”€â”€ aiStore.ts           # AI generation state
```

---

## ğŸ“± ĞĞ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ iOS

### 1. Apple Vision (Background Removal)

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**

- iOS 16+ (Vision.framework)
- Development build (Ğ½Ğµ Expo Go)

**ĞŸĞ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:**

1. `npx expo prebuild -p ios`
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Expo Module Ğ² `modules/subject-lifter/`
3. Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Swift ĞºĞ¾Ğ´ Ğ´Ğ»Ñ Apple Vision (Vision.framework)
4. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ JS bindings
5. Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² `backgroundRemover.ts` ĞºĞ°Ğº primary method Ğ´Ğ»Ñ iOS

**Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ:** [iOS_OnDevice_Background_Removal.md](./Features/iOS_OnDevice_Background_Removal.md)

### 2. UIMenu (ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ñ‹Ğµ Ğ¼ĞµĞ½Ñ)

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… **Ğ—ĞĞ’Ğ•Ğ Ğ¨Ğ•Ğ** (26 ÑĞ½Ğ²Ğ°Ñ€Ñ 2026)

**Ğ§Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ ÑĞ´ĞµĞ»Ğ°Ğ½Ğ¾:**

- âœ… Ğ’ĞºĞ»ÑÑ‡ĞµĞ½ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ UIMenu Ğ´Ğ»Ñ iOS Ğ² `GlassDropdownMenu.tsx`
- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ `ContextMenuView` Ğ´Ğ»Ñ long press ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ñ‹Ñ… Ğ¼ĞµĞ½Ñ
- âœ… Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ long press Ğ½Ğ° Ğ²ĞµÑ‰Ğ¸ Ğ² Ğ³Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±Ğµ â†’ Edit, Delete, Hide
- âœ… Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ long press Ğ½Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ñ‹ â†’ Edit, Duplicate, Share, Delete
- âœ… ĞšĞ½Ğ¾Ğ¿ĞºĞ° "..." Ğ² header Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ UIMenu Ğ½Ğ° iOS

**Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**

- iOS 13+
- ĞĞ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ (`@react-native-menu/menu` v2.0.0)
- Development build

**Ğ“Ğ´Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ:**

- Long press Ğ½Ğ° Ğ²ĞµÑ‰Ğ¸ Ğ² Ğ³Ğ°Ñ€Ğ´ĞµÑ€Ğ¾Ğ±Ğµ â†’ Edit, Delete, Hide
- Long press Ğ½Ğ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ğµ â†’ Edit, Duplicate, Share, Delete
- ĞšĞ½Ğ¾Ğ¿ĞºĞ° "..." Ğ² header â†’ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ

**ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹:**

- `components/ui/ContextMenuView.tsx` â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ´Ğ»Ñ long press Ğ¼ĞµĞ½Ñ
- `components/ui/glass/GlassDropdownMenu.tsx` â€” Ğ¼ĞµĞ½Ñ Ğ² header (USE_NATIVE_MENU = true Ğ´Ğ»Ñ iOS)
- `components/wardrobe/ItemCard.tsx` â€” ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ²ĞµÑ‰Ğ¸ Ñ context menu
- `components/outfit/OutfitCard.tsx` â€” ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ° Ñ context menu

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° (ÑƒĞ¶Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾):**

```bash
npx expo install @react-native-menu/menu
```

ĞŸĞ¾ÑĞ»Ğµ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ½ÑƒĞ¶ĞµĞ½ development build:

```bash
npx expo prebuild
npx expo run:ios
```

### 3. Liquid Glass (iOS 26+)

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** âœ… Ğ£Ğ¶Ğµ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ñ fallback

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ `expo-glass-effect` Ğ´Ğ»Ñ:

- FAB ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
- Headers Ğ½Ğ° Wardrobe Ğ¸ Outfits
- ĞĞ° iOS < 26 Ğ¸ Android â€” fallback Ğ²ĞµÑ€ÑĞ¸Ğ¸

---

## ğŸ’³ ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°

### Ğ“Ğ¸Ğ±Ñ€Ğ¸Ğ´Ğ½Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PAYMENT STRATEGY                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ğŸ‡·ğŸ‡º RUSSIA                           ğŸŒ REST OF WORLD                  â”‚
â”‚  â•â•â•â•â•â•â•â•                            â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚                                                                         â”‚
â”‚  WEB BILLING                         IN-APP PURCHASE                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚  â€¢ YooMoney/YooKassa                 â€¢ App Store (iOS)                 â”‚
â”‚  â€¢ ~3.5% commission                  â€¢ Google Play (Android)           â”‚
â”‚  â€¢ Full control                      â€¢ 15-30% commission               â”‚
â”‚  â€¢ Dashboard on Rails                â€¢ Required by Apple/Google        â”‚
â”‚                                                                         â”‚
â”‚  Why: Apple allows web billing       Why: Platform requirement         â”‚
â”‚  for Russian users (workaround)      for non-Russian users             â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¢Ğ°Ñ€Ğ¸Ñ„Ğ½Ñ‹Ğµ Ğ¿Ğ»Ğ°Ğ½Ñ‹

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€          | FREE | PRO (399â‚½/Ğ¼ĞµÑ) | MAX (799â‚½/Ğ¼ĞµÑ) |
| ----------------- | ---- | -------------- | -------------- |
| Ğ’ĞµÑ‰Ğ¸ Ğ² ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³Ğµ   | 100  | 250            | 500            |
| Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ¾Ğ½Ğ°/Ğ¼ĞµÑ | 50   | 100            | 200            |
| AI-Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ²/Ğ¼ĞµÑ    | 5    | 50             | 150            |
| Ğ ĞµĞºĞ»Ğ°Ğ¼Ğ°           | Ğ”Ğ°   | ĞĞµÑ‚            | ĞĞµÑ‚            |

### Ğ¢Ğ¾ĞºĞµĞ½Ñ‹ (AI Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸)

| ĞŸĞ°ĞºĞµÑ‚  | Ğ¢Ğ¾ĞºĞµĞ½Ğ¾Ğ² | Ğ¦ĞµĞ½Ğ° (â‚½) | Ğ¦ĞµĞ½Ğ° ($) |
| ------ | ------- | -------- | -------- |
| Small  | 10      | 99â‚½      | $1.49    |
| Medium | 30      | 249â‚½     | $3.49    |
| Large  | 100     | 699â‚½     | $9.99    |
| XL     | 300     | 1799â‚½    | $24.99   |

**Ğ¡Ñ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹:**

- Virtual Try-On: 1 Ñ‚Ğ¾ĞºĞµĞ½
- Fashion Model: 1 Ñ‚Ğ¾ĞºĞµĞ½
- Variation: 1 Ñ‚Ğ¾ĞºĞµĞ½
- Outfit Generation: 2 Ñ‚Ğ¾ĞºĞµĞ½Ğ° (ÑĞ»Ğ¾Ğ¶Ğ½ĞµĞµ)

---

## ğŸ’¾ Ğ¥Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ°

### Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA STORAGE                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  LOCAL (on device)                   CLOUD (Supabase)                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚  â€¢ Wardrobe images                   â€¢ User metadata                   â”‚
â”‚  â€¢ Outfit previews                   â€¢ Item metadata                   â”‚
â”‚  â€¢ Cached data                       â€¢ Outfit metadata                 â”‚
â”‚                                      â€¢ AI generation results           â”‚
â”‚                                                                         â”‚
â”‚  expo-file-system                    PostgreSQL + Storage              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞŸĞ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ AI-Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** The New Black ÑƒĞ´Ğ°Ğ»ÑĞµÑ‚ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· 48 Ñ‡Ğ°ÑĞ¾Ğ².

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**

1. **Rails ÑĞºĞ°Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ ÑÑ€Ğ°Ğ·Ñƒ** Ğ¿Ğ¾ÑĞ»Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
2. **Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ² Supabase Storage** (bucket: `ai-generations`)
3. **ĞĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ¼ 3 Ğ´Ğ½Ñ** (Ğ¿Ğ¾Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° retention)
4. **ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ** Ğ² ÑĞ²Ğ¾Ñ ĞºĞ¾Ğ»Ğ»ĞµĞºÑ†Ğ¸Ñ (Ñ‚Ğ¾Ğ³Ğ´Ğ° Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑÑ Ğ´Ğ¾Ğ»ÑŒÑˆĞµ)

```ruby
# app/jobs/cleanup_ai_generations_job.rb
class CleanupAiGenerationsJob < ApplicationJob
  def perform
    # Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ AI-Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ ÑÑ‚Ğ°Ñ€ÑˆĞµ 3 Ğ´Ğ½ĞµĞ¹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼
    AiGeneration
      .where('created_at < ?', 3.days.ago)
      .where(saved_to_collection: false)
      .find_each do |generation|
        # Ğ£Ğ´Ğ°Ğ»ÑĞµĞ¼ Ñ„Ğ°Ğ¹Ğ» Ğ¸Ğ· Storage
        Supabase::SyncService.new.delete_file(generation.result_url)
        generation.destroy
      end
  end
end

# config/schedule.rb (Sidekiq-scheduler)
cleanup_ai_generations:
  cron: '0 3 * * *'  # ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ Ğ² 3:00
  class: CleanupAiGenerationsJob
```

### Privacy & Security

1. **Ğ¤Ğ¾Ñ‚Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹:**
   - Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ (Ğ´Ğ»Ñ AI) â€” Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ max 3 Ğ´Ğ½Ñ
   - ĞŸÑ€Ğ¸ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ° â€” Ğ²ÑÑ‘ ÑƒĞ´Ğ°Ğ»ÑĞµÑ‚ÑÑ
   - ĞĞµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ğ¼ Ñ‚Ñ€ĞµÑ‚ÑŒĞ¸Ğ¼ Ğ»Ğ¸Ñ†Ğ°Ğ¼ (ĞºÑ€Ğ¾Ğ¼Ğµ The New Black Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸)

2. **Supabase RLS:**
   - Users Ğ²Ğ¸Ğ´ÑÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑĞ²Ğ¾Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   - Service-role key Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° backend

3. **Signed URLs:**
   - Ğ”Ğ»Ñ private bucket â€” Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸
   - TTL: 1 Ñ‡Ğ°Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ°, 24 Ñ‡Ğ°ÑĞ° Ğ´Ğ»Ñ download

---

## ğŸ“… Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Roadmap Ğ¿Ğ¾ ÑÑ‚Ğ°Ğ´Ğ¸ÑĞ¼

### Stage 5: AI Functions (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)

#### 5.1 Rails Backend Foundation (1 Ğ½ĞµĞ´ĞµĞ»Ñ)

- [ ] Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Rails 7.2 Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
- [ ] JWT authentication (Supabase integration)
- [ ] ĞœĞ¾Ğ´ĞµĞ»Ğ¸: User, Subscription, TokenBalance, TokenTransaction, AiGeneration
- [ ] API endpoints: /subscription, /tokens
- [ ] Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ½Ğ° Render (free tier)

#### 5.2 The New Black Integration (1 Ğ½ĞµĞ´ĞµĞ»Ñ)

- [ ] The New Black API client
- [ ] VirtualTryon, FashionModels, Variations services
- [ ] ProcessAiGenerationJob (Sidekiq)
- [ ] Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ² Supabase Storage
- [ ] API endpoints: /ai/virtual_tryon, /ai/fashion_model, /ai/generations/:id

#### 5.3 Mobile AI UI (1 Ğ½ĞµĞ´ĞµĞ»Ñ)

- [ ] AI Try-On screen
- [ ] PhotoUploader component
- [ ] ItemSelector component
- [ ] GenerationLoader animation
- [ ] ResultView Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸ĞµĞ¼/ÑˆĞµÑ€Ğ¸Ğ½Ğ³Ğ¾Ğ¼
- [ ] aiService.ts + aiStore.ts

### Stage 6: Subscriptions & Payments (2-3 Ğ½ĞµĞ´ĞµĞ»Ğ¸)

#### 6.1 Web Billing (Russia) (1 Ğ½ĞµĞ´ĞµĞ»Ñ)

- [ ] YooKassa integration
- [ ] Payment flow (redirect â†’ webhook)
- [ ] Subscription activation
- [ ] Token purchase flow
- [ ] Dashboard: subscription page

#### 6.2 In-App Purchase (1-2 Ğ½ĞµĞ´ĞµĞ»Ğ¸)

- [ ] iOS StoreKit configuration
- [ ] Android Play Billing configuration
- [ ] Receipt validation on Rails
- [ ] Server-to-Server notifications
- [ ] Mobile IAP screens

#### 6.3 Paywall (3-5 Ğ´Ğ½ĞµĞ¹)

- [ ] Paywall component
- [ ] Region detection (Russia vs other)
- [ ] A/B testing setup
- [ ] Soft paywall logic

### Stage 7: Native Features (1 Ğ½ĞµĞ´ĞµĞ»Ñ)

#### 7.1 Development Build Setup (1-2 Ğ´Ğ½Ñ)

- [ ] `npx expo prebuild -p ios`
- [ ] EAS Build configuration
- [ ] Test development build

#### 7.2 Apple Vision Background Removal (3-5 Ğ´Ğ½ĞµĞ¹)

- [x] Create subject-lifter Expo module
- [x] Implement Apple Vision (Vision.framework) logic
- [x] Integrate into backgroundRemover.ts
- [x] Test on real device

#### 7.3 UIMenu (1-2 Ğ´Ğ½Ñ)

- [x] Install @react-native-menu/menu
- [x] Add context menus to wardrobe items
- [x] Add context menus to outfits

### Stage 8: Onboarding & Polish (1-2 Ğ½ĞµĞ´ĞµĞ»Ğ¸)

#### 8.1 Onboarding (3-5 Ğ´Ğ½ĞµĞ¹)

- [ ] Welcome screens
- [ ] AI demo/preview
- [ ] Style preferences quiz (optional)
- [ ] First item adding prompt

#### 8.2 Push Notifications (3-5 Ğ´Ğ½ĞµĞ¹)

- [ ] expo-notifications setup
- [ ] Backend integration
- [ ] Streak reminders
- [ ] New feature announcements

#### 8.3 Gamification (3-5 Ğ´Ğ½ĞµĞ¹)

- [ ] Streak system
- [ ] Achievements
- [ ] Daily challenges

### Stage 9: Testing & Release (1-2 Ğ½ĞµĞ´ĞµĞ»Ğ¸)

#### 9.1 Testing

- [ ] Unit tests (Jest)
- [ ] Integration tests (backend)
- [ ] E2E tests (Maestro/Detox)
- [ ] Manual QA

#### 9.2 App Store Preparation

- [ ] Screenshots
- [ ] App description
- [ ] Privacy policy
- [ ] Review guidelines compliance

#### 9.3 Release

- [ ] TestFlight beta
- [ ] Google Play beta
- [ ] Soft launch
- [ ] Full release

---

## ğŸ“Š Timeline Summary

| Stage                 | Duration  | Dependencies |
| --------------------- | --------- | ------------ |
| **Stage 5: AI**       | 2-3 weeks | â€”            |
| **Stage 6: Payments** | 2-3 weeks | Stage 5      |
| **Stage 7: Native**   | 1 week    | Stage 5      |
| **Stage 8: Polish**   | 1-2 weeks | Stage 6      |
| **Stage 9: Release**  | 1-2 weeks | Stage 8      |

**Total estimated time to release: 8-12 weeks**

---

## âš¡ Quick Wins (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾)

1. **Development build** â€” Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ñ„Ğ¸Ñ‡Ğ¸
2. **Apple Vision** â€” ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ñ‚ UX Ğ´Ğ»Ñ iOS Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
3. **Onboarding screens** â€” Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ backend
4. **Export outfit as image** â€” react-native-view-shot ÑƒĞ¶Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½

---

## ğŸ“š Ğ¡Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹

- [Backend.md](./Extra/Features/Backend.md) â€” Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° backend
- [THE_NEW_BLACK_AI_SERVICE_ANALYSIS.md](./Extra/Features/THE_NEW_BLACK_AI_SERVICE_ANALYSIS.md) â€” ĞĞ½Ğ°Ğ»Ğ¸Ğ· AI API
- [iOS_OnDevice_Background_Removal_Plan.md](./Features/iOS_OnDevice_Background_Removal_Plan.md) â€” Apple Vision Ğ¿Ğ»Ğ°Ğ½
- [Implementation.md](./Implementation.md) â€” ĞĞ±Ñ‰Ğ¸Ğ¹ roadmap Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°
- [TechStack.md](./TechStack.md) â€” Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº
- [PRDobrazz.md](./PRDobrazz.md) â€” Product Requirements

---

> **Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³:** ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ development build Ğ´Ğ»Ñ iOS, Ğ·Ğ°Ñ‚ĞµĞ¼ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ½Ğ°Ğ´ Rails backend Ğ¸ Apple Vision Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¼.
