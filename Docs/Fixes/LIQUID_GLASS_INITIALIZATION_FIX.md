# Liquid Glass Initialization Fix (Wardrobe)

> **–î–∞—Ç–∞:** 2025-12-21  
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (deferred enable + run-once)  
> **–°–∏–º–ø—Ç–æ–º:** –ù–∞ –ø–µ—Ä–≤–æ–º —Ö–æ–ª–æ–¥–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ Wardrobe iOS 26+ –ø–æ–∫–∞–∑—ã–≤–∞–ª —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–Ω—Ç (–∏–∫–æ–Ω–∫–∏/—Ç–µ–∫—Å—Ç) –±–µ–∑ —Å—Ç–µ–∫–ª—è–Ω–Ω–æ–≥–æ —Ñ–æ–Ω–∞. –ü–æ—Å–ª–µ —É—Ö–æ–¥–∞ –Ω–∞ –¥—Ä—É–≥–æ–π —Ç–∞–± –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ ‚Äî —ç—Ñ—Ñ–µ–∫—Ç –ø–æ—è–≤–ª—è–ª—Å—è.

---

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ iOS 26+ (—Å –¥–æ—Å—Ç—É–ø–Ω—ã–º `expo-glass-effect`) —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã Wardrobe (–ø–æ–∏—Å–∫, –º–µ–Ω—é, FAB) –∏–Ω–æ–≥–¥–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª–∏—Å—å —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ ‚Äî –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏/–ª–µ–π–∞—É—Ç–∞.

–†–µ–∑—É–ª—å—Ç–∞—Ç:

- `GlassView` –ø–æ—è–≤–ª—è–ª—Å—è, –Ω–æ –Ω–∞—Ç–∏–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –º–æ–≥ –Ω–µ ‚Äú–ø—Ä–∏—Ü–µ–ø–∏—Ç—å—Å—è‚Äù –≤ —ç—Ç–æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–∞–Ω–Ω–∏–π –º–æ–º–µ–Ω—Ç.
- –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞—Ö–æ–¥–µ —ç–∫—Ä–∞–Ω —É–∂–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–ª—Å—è –≤ ¬´—Å—Ç–∞–±–∏–ª—å–Ω–æ–º¬ª —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç —Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º.

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1) –ï–¥–∏–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É bundle)

–í–º–µ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤–µ—Ä—Å–∏–∏ iOS –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Liquid Glass –ø–æ —Ñ–∞–π–ª–∞–º ‚Äî –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã:

- `utils/platform.ts` —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç:
  - `IS_IOS_26_OR_NEWER`
  - `CAN_USE_LIQUID_GLASS` (iOS 26+ –∏ `isLiquidGlassAvailable()`)

–≠—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ª–æ–≥–∏–∫–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### 2) Deferred enable –≤ Wardrobe: –≤–∫–ª—é—á–∞–µ–º glass UI —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ ¬´–≤—Å—ë –≥–æ—Ç–æ–≤–æ¬ª

–í `app/(tabs)/wardrobe.tsx` —Å—Ç–µ–∫–ª—è–Ω–Ω–∞—è UI-–≤–µ—Ç–∫–∞ **–Ω–µ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–º –∫–∞–¥—Ä–µ**. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞:

1. —ç–∫—Ä–∞–Ω –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤ —Ñ–æ–∫—É—Å–µ (`useFocusEffect`)
2. –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–∂–µ –ø—Ä–æ—à—ë–ª –ø–µ—Ä–≤—ã–π layout (`onLayout`)
3. –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å –ø–µ—Ä–≤–∏—á–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è/–∞–Ω–∏–º–∞—Ü–∏–∏ (`InteractionManager.runAfterInteractions`)
4. –ø—Ä–æ—à–ª–∏ 2 –∫–∞–¥—Ä–∞ —á–µ—Ä–µ–∑ `requestAnimationFrame` (—á—Ç–æ–±—ã –æ—Ç–¥–∞—Ç—å React –≤—Ä–µ–º—è –Ω–∞ commit/layout)

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º ¬´—ç—Ñ—Ñ–µ–∫—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤–æ–∑–≤—Ä–∞—Ç–∞¬ª, –Ω–æ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

### 3) Run-once: –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è ‚Äî –Ω–µ –æ—Ç–∫–ª—é—á–∞–µ–º –Ω–∞ blur

–ö–æ–≥–¥–∞ `useLiquidGlassUI` —É–∂–µ `true`, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Ñ–æ–∫—É—Å—ã —Ç–∞–±–∞ **–Ω–µ –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç** —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã. –≠—Ç–æ —É–±–∏—Ä–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ ¬´–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è¬ª –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞—Ö —Ç—É–¥–∞-—Å—é–¥–∞.

### 4) –ë–µ–∑ —Ñ–ª–∏–∫–∞ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ UI –Ω–∞ iOS 26+

–ù–∞ iOS 26+ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Liquid Glass –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ö–µ–¥–µ—Ä –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ¬´–Ω–∞ –¥–æ–ª—é —Å–µ–∫—É–Ω–¥—ã¬ª, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Å–∫–∞—á–∫–æ–≤/–º–∏–≥–∞–Ω–∏—è.

---

## üìã –ß—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–æ

- `utils/platform.ts` ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞/–ø–æ–¥–¥–µ—Ä–∂–∫–∞ Liquid Glass –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É.
- `app/(tabs)/wardrobe.tsx` ‚Äî –≤–∫–ª—é—á–µ–Ω–∏–µ glass UI –æ—Ç–ª–æ–∂–µ–Ω–æ –¥–æ focus+layout+interactions; –≤–∫–ª—é—á–µ–Ω–∏–µ run-once.
- `components/ui/glass/*` –∏ `components/ui/FAB.tsx` ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–π `CAN_USE_LIQUID_GLASS` (–±–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –≤–µ—Ä—Å–∏–æ–Ω–Ω—ã—Ö —Ö–µ–ª–ø–µ—Ä–æ–≤).

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –ü–æ–ª–Ω—ã–π kill –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí –∑–∞–ø—É—Å–∫ ‚Üí —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã—Ç—å Wardrobe:

- —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–π —Ñ–æ–Ω —É –ø–æ–∏—Å–∫–∞/–º–µ–Ω—é/FAB –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∏–¥–µ–Ω –Ω–∞ –ø–µ—Ä–≤–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏.

2. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤ —Ç—É–¥–∞-—Å—é–¥–∞:

- —Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏, –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ ‚Äú–∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∏—è‚Äù.

---

## üìö –°—Å—ã–ª–∫–∏

- React Native InteractionManager: https://reactnative.dev/docs/interactionmanager
- Expo Glass Effect: https://docs.expo.dev/versions/latest/sdk/glass-effect/
