# üîß –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–∞—Ä–¥–µ—Ä–æ–±–∞

## –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–¥–∞

‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ rehydration –¥–ª—è `wardrobeStore` –∏ `outfitStore` –≤ `app/_layout.tsx`

–ù–æ –µ—Å–ª–∏ –≤–µ—â–∏ –≤—Å—ë –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.

---

## üõ†Ô∏è –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (DEV)

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (Expo DevTools):

```javascript
// 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
checkWardrobe();

// 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ò –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
fixWardrobe();
```

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

1. ‚úÖ **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã items** - –º–æ–∂–µ—Ç –ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–∏—Ç–∞—Ç—å –∏–∑ –ë–î
2. ‚úÖ **–°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≤–µ—â–∏** - –µ—Å—Ç—å –ª–∏ 20 —à–∞–±–ª–æ–Ω–æ–≤ –≤ –ë–î
3. ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - –≤–æ—à—ë–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Å–∏—Å—Ç–µ–º—É
4. ‚úÖ **–í–µ—â–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** - —Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π –≤ –≥–∞—Ä–¥–µ—Ä–æ–±–µ
5. ‚úÖ **RLS –ø–æ–ª–∏—Ç–∏–∫–∏** - —Ä–∞–±–æ—Ç–∞—é—Ç –ª–∏ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
6. ‚úÖ **–¢—Ä–∏–≥–≥–µ—Ä—ã –ë–î** - –¥–æ—Å—Ç—É–ø–Ω—ã –ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

- üîß **–ù–µ—Ç –≤–µ—â–µ–π —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Üí –ö–æ–ø–∏—Ä—É–µ—Ç 20 –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –≤–µ—â–µ–π
- üîß **RLS –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø** ‚Üí –í—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏

---

## üì± –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
npx expo start --clear
```

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ DevTools

1. –ù–∞–∂–º–∏—Ç–µ `j` –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ Expo –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è DevTools
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
checkWardrobe();
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**

```
üîç Starting Wardrobe Database Diagnostics...

üìä Diagnostic Results:

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

‚úÖ Items Table Accessibility
   Status: OK
   Value: true
   Items table is accessible

‚úÖ System Default Items
   Status: OK
   Value: 20
   Correct: 20 system default items

‚úÖ User Authentication
   Status: OK
   Value: abc123-user-id
   User authenticated: user@example.com

‚ö†Ô∏è  User Wardrobe Items
   Status: WARNING
   Value: 0
   User has no items yet (need to copy defaults)

‚úÖ RLS Policy - Read Own Items
   Status: OK
   Value: true
   User can read their own items

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìã Summary:

‚ö†Ô∏è  WARNINGS PRESENT - System should work but needs attention
   Some optimizations or fixes may be needed

üí° Tip: User has no items. To auto-fix, call:
   runWardrobeDiagnostics(true)
```

### –®–∞–≥ 4: –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑–∞–ª–∞ –ø—Ä–æ–±–ª–µ–º—ã:

```javascript
fixWardrobe();
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**

```
üîß Attempting to fix user wardrobe...

üë§ User: user@example.com
üì¶ Current items count: 0

üîÑ Copying default items to user...
üìã Found 20 default items to copy
‚úÖ Successfully copied 20 items to user wardrobe

üîÑ Re-running diagnostics after fix...

[–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ OK]
```

---

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot access items table"

**–ü—Ä–∏—á–∏–Ω–∞:** RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥–æ—Å—Ç—É–ø –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Supabase Dashboard ‚Üí Table Editor ‚Üí items
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
   - Users can view own items and defaults
   - Users can insert own items

### –ü—Ä–æ–±–ª–µ–º–∞: "No default items found"

**–ü—Ä–∏—á–∏–Ω–∞:** –í –ë–î –Ω–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –≤–µ—â–µ–π (user_id IS NULL)

**–†–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Supabase SQL Editor:**

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –≤–µ—â–µ–π
SELECT COUNT(*) FROM items
WHERE user_id IS NULL AND is_default = true;

-- –ï—Å–ª–∏ 0, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≤–µ—â–∏ (–æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É)
```

### –ü—Ä–æ–±–ª–µ–º–∞: "User has no items yet"

**–ü—Ä–∏—á–∏–Ω–∞:** –¢—Ä–∏–≥–≥–µ—Ä –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≤–µ—â–∏ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**

```javascript
fixWardrobe(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ–ø–∏—Ä—É–µ—Ç –≤–µ—â–∏
```

### –ü—Ä–æ–±–ª–µ–º–∞: "No authenticated user"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–æ—à—ë–ª –≤ —Å–∏—Å—Ç–µ–º—É

**–†–µ—à–µ–Ω–∏–µ:**

1. –í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É

---

## üîç –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ SQL

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î –Ω–∞–ø—Ä—è–º—É—é:

```sql
-- 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –≤–µ—â–∏
SELECT id, name, category, user_id, is_default
FROM items
WHERE user_id IS NULL AND is_default = true;
-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 20 –∑–∞–ø–∏—Å–µ–π

-- 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—â–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT id, name, category, user_id, is_default
FROM items
WHERE user_id = 'YOUR_USER_ID'
ORDER BY created_at DESC;

-- 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS –ø–æ–ª–∏—Ç–∏–∫–∏
SELECT schemaname, tablename, policyname, cmd, qual
FROM pg_policies
WHERE tablename = 'items';
```

---

## üìä –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

1. **–û—á–∏—Å—Ç–∏—Ç–µ AsyncStorage:**

   ```javascript
   // –í –∫–æ–Ω—Å–æ–ª–∏ DevTools
   import('expo-sqlite').then((m) => m.default.deleteDatabaseAsync('wardrobe-storage'));
   ```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

   ```bash
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Expo (Ctrl+C)
   npx expo start --clear
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Å–æ–ª–∏:**
   –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏ –≤–∏–¥–∞:

   ```
   [RootLayoutNav] Rehydrating stores...
   [ItemService.getUserItems] Fetching items for user: ...
   [ItemService.getUserItems] Fetched items count: 20
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç—å:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Supabase Dashboard (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–Ω–ª–∞–π–Ω)

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- [ ] `checkWardrobe()` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ ‚úÖ (–±–µ–∑ ‚ùå –æ—à–∏–±–æ–∫)
- [ ] –≠–∫—Ä–∞–Ω "–ì–∞—Ä–¥–µ—Ä–æ–±" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—â–∏
- [ ] `fixWardrobe()` —É—Å–ø–µ—à–Ω–æ –∫–æ–ø–∏—Ä—É–µ—Ç –≤–µ—â–∏, –µ—Å–ª–∏ –∏—Ö –Ω–µ –±—ã–ª–æ
- [ ] –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–µ—â–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ
- [ ] –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–µ—â–∏

---

**–ê–≤—Ç–æ—Ä:** GitHub Copilot  
**–î–∞—Ç–∞:** 17 –¥–µ–∫–∞–±—Ä—è 2025
