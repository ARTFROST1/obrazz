# üîç –ê–ù–ê–õ–ò–ó WORKFLOW –°–û–ó–î–ê–ù–ò–Ø –û–ë–†–ê–ó–ê

**–î–∞—Ç–∞:** 2025-11-09 21:47  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–∏ —Ç—Ä–µ–±—É–µ–º–æ–π

---

## üìã –¢–†–ï–ë–£–ï–ú–ê–Ø –õ–û–ì–ò–ö–ê (–û–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø)

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ outfit

- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è **4-–∞—è –≤–∫–ª–∞–¥–∫–∞ (Custom)** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –û–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–≤—Ç–æ—Ä—è–µ—Ç **1-—É—é –≤–∫–ª–∞–¥–∫—É (Basic)** –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º: `['tops', 'bottoms', 'footwear']`
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –Ω–∞–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –≤—ã–±–∏—Ä–∞—Ç—å –≤–µ—â–∏

### 2. –°–º–µ–Ω–∞ –≤–∫–ª–∞–¥–æ–∫

- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ (Basic, Dress, All, Custom)
- ‚úÖ –í—ã–±–∏—Ä–∞—Ç—å –≤–µ—â–∏ –Ω–∞ –ª—é–±–æ–π –≤–∫–ª–∞–¥–∫–µ

### 3. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Step 2 (–ö–æ–º–ø–æ–∑–∏—Ü–∏—è)

- ‚úÖ –ü–µ—Ä–µ–¥–∞—é—Ç—Å—è **–ò–ú–ï–ù–ù–û –¢–ï –í–ï–©–ò**, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –Ω–∞ **–ê–ö–¢–ò–í–ù–û–ô –≤–∫–ª–∞–¥–∫–µ** –≤ –º–æ–º–µ–Ω—Ç –Ω–∞–∂–∞—Ç–∏—è "–î–∞–ª–µ–µ"
- ‚úÖ –ï—Å–ª–∏ –Ω–∞ Custom ‚Üí –Ω–∞–±–æ—Ä –∏–∑ Custom
- ‚úÖ –ï—Å–ª–∏ –Ω–∞ Dress ‚Üí —Ç–µ 3 –≤–µ—â–∏ –∏–∑ Dress
- ‚úÖ –ï—Å–ª–∏ –Ω–∞ Basic ‚Üí —Ç–µ 3 –≤–µ—â–∏ –∏–∑ Basic
- ‚úÖ –ï—Å–ª–∏ –Ω–∞ All ‚Üí –≤—Å–µ 8 –≤–µ—â–µ–π –∏–∑ All

### 4. –ù–∞ —ç–∫—Ä–∞–Ω–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏

- ‚úÖ –ù–∞–±–æ—Ä –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è (–≤–µ—â–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã)

### 5. –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è **–∫–∞–∫–∏–µ –∫–∞—Ä—É—Å–µ–ª–∏/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏** –±—ã–ª–∏ –≤ —ç—Ç–æ–º –æ–±—Ä–∞–∑–µ
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è **–∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ –≤–µ—â—å** –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ä—É—Å–µ–ª–∏
- ‚úÖ –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 6. –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

- ‚úÖ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–¥–µ –≤—Å–µ **–∫–∞—Ä—É—Å–µ–ª–∏ –Ω–∞ —Å–≤–æ–∏—Ö –º–µ—Å—Ç–∞—Ö**
- ‚úÖ **–í—ã–±—Ä–∞–Ω—ã –∏–º–µ–Ω–Ω–æ –≤–µ—â–∏**, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –≤ –æ–±—Ä–∞–∑–µ –µ—Å—Ç—å
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —á—Ç–æ –±—ã–ª –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

---

## üîé –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### üìÇ `store/outfit/outfitStore.ts`

#### Initial State (—Å—Ç—Ä–æ–∫–∏ 117-132)

```typescript
currentOutfit: null,
currentItems: [],
currentBackground: defaultBackground,
canvasSettings: defaultCanvasSettings,
creationStep: 1,
selectedItemsForCreation: createEmptySelection(DEFAULT_CUSTOM_CATEGORIES.length),
activeTab: 'basic', // ‚ùå –ü–†–û–ë–õ–ï–ú–ê #1
customTabCategories: DEFAULT_CUSTOM_CATEGORIES, // ‚úÖ = ['tops', 'bottoms', 'footwear']
customTabOrder: DEFAULT_CUSTOM_CATEGORIES.map((_, i) => i),
isCustomTabEditing: false,
```

**–ü–†–û–ë–õ–ï–ú–ê #1:** `activeTab: 'basic'` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `activeTab: 'custom'`

---

#### setActiveTab() (—Å—Ç—Ä–æ–∫–∏ 355-357)

```typescript
setActiveTab: (tab) => {
  set({ activeTab: tab });
},
```

**–ü–†–û–ë–õ–ï–ú–ê #2:** –ü—Ä–∏ —Å–º–µ–Ω–µ –≤–∫–ª–∞–¥–∫–∏ –ù–ï —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è `selectedItemsForCreation` —Å –Ω–æ–≤—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏!

**–ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢:**

- User –Ω–∞ Basic (3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏), –≤—ã–±—Ä–∞–ª –≤–µ—â–∏ ‚Üí `selectedItemsForCreation` = [item1, item2, item3]
- User –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ All (8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π)
- `selectedItemsForCreation` –æ—Å—Ç–∞–µ—Ç—Å—è [item1, item2, item3] - —Ç–æ–ª—å–∫–æ 3 —ç–ª–µ–º–µ–Ω—Ç–∞ –≤–º–µ—Å—Ç–æ 8! ‚ùå
- –ö–∞—Ä—É—Å–µ–ª–∏ 4-8 –Ω–µ –∏–º–µ—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–ª–æ—Ç–æ–≤ –≤ `selectedItemsForCreation`

---

#### getActiveTabCategories() (—Å—Ç—Ä–æ–∫–∏ 433-448)

```typescript
getActiveTabCategories: () => {
  const { activeTab, customTabCategories } = get();

  switch (activeTab) {
    case 'basic':
      return ['tops', 'bottoms', 'footwear'];
    case 'dress':
      return ['fullbody', 'footwear', 'accessories'];
    case 'all':
      return CATEGORIES; // 8 categories
    case 'custom':
      return customTabCategories;
    default:
      return CATEGORIES;
  }
};
```

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏

---

#### confirmItemSelection() (—Å—Ç—Ä–æ–∫–∏ 280-323)

```typescript
confirmItemSelection: () => {
  const selected = get().selectedItemsForCreation;
  const categories = get().customTabCategories; // ‚ùå –ü–†–û–ë–õ–ï–ú–ê #3

  const outfitItems: OutfitItem[] = [];

  selected.forEach((item, slotIndex) => {
    if (item && categories[slotIndex]) {
      const category = categories[slotIndex];
      // ... create outfitItem
      outfitItems.push({ ... });
    }
  });

  console.log('üíæ [outfitStore] Saving customTabCategories to canvasSettings:', categories);

  set({
    currentItems: outfitItems,
    creationStep: 2,
    canvasSettings: {
      ...currentSettings,
      customTabCategories: categories, // ‚ùå –ü–†–û–ë–õ–ï–ú–ê #4
    },
  });
}
```

**–ü–†–û–ë–õ–ï–ú–ê #3:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `customTabCategories` –≤–º–µ—Å—Ç–æ `getActiveTabCategories()`

- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –≤–µ—â–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ Dress –∏ –Ω–∞–∂–∞–ª "–î–∞–ª–µ–µ"
- –ù–æ `categories` = `customTabCategories` (–Ω–∞–ø—Ä–∏–º–µ—Ä ['tops', 'bottoms', 'footwear'])
- –ê –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å ['fullbody', 'footwear', 'accessories'] ‚ùå

**–ü–†–û–ë–õ–ï–ú–ê #4:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `canvasSettings` —Ç–æ–ª—å–∫–æ `customTabCategories`, –∞ –Ω–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏

- –ï—Å–ª–∏ outfit —Å–æ–∑–¥–∞–Ω –Ω–∞ –≤–∫–ª–∞–¥–∫–µ Dress, –≤ –ë–î —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ custom, –∞ –Ω–µ dress ‚ùå

---

#### setCurrentOutfit() (—Å—Ç—Ä–æ–∫–∏ 135-197)

```typescript
setCurrentOutfit: (outfit) => {
  // ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç customTabCategories
  let customCategories: ItemCategory[];

  if (outfit?.canvasSettings?.customTabCategories) {
    customCategories = outfit.canvasSettings.customTabCategories;
  } else if (outfit?.items && outfit.items.length > 0) {
    customCategories = sortedItems.map((item) => item.category);
  } else {
    customCategories = DEFAULT_CUSTOM_CATEGORIES;
  }

  // ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç selectedItems
  const selectedItems: (WardrobeItem | null)[] = createEmptySelection(customCategories.length);

  if (outfit?.items) {
    const sortedItems = [...outfit.items].sort((a, b) => a.slot - b.slot);
    sortedItems.forEach((outfitItem) => {
      if (outfitItem.item && outfitItem.slot < selectedItems.length) {
        selectedItems[outfitItem.slot] = outfitItem.item;
      }
    });
  }

  set({
    currentOutfit: outfit,
    currentItems: outfit?.items || [],
    currentBackground: outfit?.background || defaultBackground,
    selectedItemsForCreation: selectedItems,
    customTabCategories: customCategories, // ‚úÖ Restore
    activeTab: customCategories.length === 3 && customCategories[0] === 'tops' ? 'basic' : 'custom', // ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #5
    canvasSettings: outfit?.canvasSettings || defaultCanvasSettings,
    error: null,
  });
};
```

**–ü–†–û–ë–õ–ï–ú–ê #5:** Smart detection –Ω–µ–ø–æ–ª–Ω—ã–π

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ basic (3 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ + tops first)
- –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç dress: ['fullbody', 'footwear', 'accessories']
- –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç all: 8 –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢:**

- –ï—Å–ª–∏ outfit —Å–æ–∑–¥–∞–Ω –Ω–∞ Dress ‚Üí –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Custom, –∞ –Ω–µ Dress ‚ùå

---

### üìÇ `components/outfit/ItemSelectionStepNew.tsx`

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ activeTab (—Å—Ç—Ä–æ–∫–∏ 22-58)

```typescript
const {
  currentOutfit,
  selectedItemsForCreation,
  selectItemForCategory,
  // ...
  activeTab,
  setActiveTab,
  customTabCategories,
  updateCustomTab,
  getActiveTabCategories,
} = useOutfitStore();

const isEditMode = !!currentOutfit;
const currentTabCategories = getActiveTabCategories(); // ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏

const selectedCount = getSelectedItemsCount();
```

‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `getActiveTabCategories()` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—É—Å–µ–ª–µ–π

---

## üö® –í–´–Ø–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê #1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—á–∞–ª—å–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞

**–ì–¥–µ:** `outfitStore.ts:123`

```typescript
activeTab: 'basic', // ‚ùå –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 'custom'
```

**–í–ª–∏—è–Ω–∏–µ:**

- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ outfit –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Basic –≤–º–µ—Å—Ç–æ Custom
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–µ —Ç—É –≤–∫–ª–∞–¥–∫—É

---

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê #2: selectedItemsForCreation –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –≤–∫–ª–∞–¥–∫–∏

**–ì–¥–µ:** `outfitStore.ts:355-357`

```typescript
setActiveTab: (tab) => {
  set({ activeTab: tab });
  // ‚ùå –ù–ï–¢ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ selectedItemsForCreation!
},
```

**–í–ª–∏—è–Ω–∏–µ:**

- –ï—Å–ª–∏ –Ω–∞ Basic (3 —Å–ª–æ—Ç–∞), –≤—ã–±—Ä–∞–Ω–æ 3 –≤–µ—â–∏
- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ All (8 —Å–ª–æ—Ç–æ–≤)
- selectedItemsForCreation –æ—Å—Ç–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Ä–æ–º 3
- –°–ª–æ—Ç—ã 4-8 –Ω–µ –∏–º–µ—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –≤ –º–∞—Å—Å–∏–≤–µ ‚ùå
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –≤–µ—â–∏ –≤ —Å–ª–æ—Ç–µ 5 ‚Üí crash –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

- –ü—Ä–∏ —Å–º–µ–Ω–µ –≤–∫–ª–∞–¥–∫–∏ –ü–ï–†–ï–°–û–ó–î–ê–¢–¨ `selectedItemsForCreation` –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
- –ü–û–ü–´–¢–ê–¢–¨–°–Ø —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä—ã –≥–¥–µ category —Å–æ–≤–ø–∞–¥–∞–µ—Ç
- –ü—Ä–∏–º–µ—Ä: Basic ['tops', 'bottoms', 'footwear'] ‚Üí Dress ['fullbody', 'footwear', 'accessories']
  - 'footwear' —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä footwear –∏–∑ Basic –≤ Dress

---

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê #3: confirmItemSelection –∏—Å–ø–æ–ª—å–∑—É–µ—Ç customTabCategories –≤–º–µ—Å—Ç–æ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏

**–ì–¥–µ:** `outfitStore.ts:282`

```typescript
const categories = get().customTabCategories; // ‚ùå
// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
// const categories = get().getActiveTabCategories();
```

**–í–ª–∏—è–Ω–∏–µ:**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –≤–µ—â–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ Dress
- –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞–ª–µ–µ"
- –í outfitItems –ø–æ–ø–∞–¥–∞—é—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–∑ customTabCategories, –∞ –Ω–µ –∏–∑ Dress ‚ùå
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–µ—â—å-–∫–∞—Ç–µ–≥–æ—Ä–∏—è

---

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê #4: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è customTabCategories –≤–º–µ—Å—Ç–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–ì–¥–µ:** `outfitStore.ts:288, 321`

```typescript
customTabCategories: categories, // ‚ùå
// –î–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è —Ç–æ, —á—Ç–æ –±—ã–ª–æ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
```

**–í–ª–∏—è–Ω–∏–µ:**

- Outfit —Å–æ–∑–¥–∞–Ω –Ω–∞ Dress
- –í –ë–î —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è customTabCategories (–Ω–∞–ø—Ä–∏–º–µ—Ä ['tops', 'bottoms', 'footwear'])
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚ùå

---

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #5: –ù–µ–ø–æ–ª–Ω—ã–π smart tab detection –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

**–ì–¥–µ:** `outfitStore.ts:194`

```typescript
activeTab: customCategories.length === 3 && customCategories[0] === 'tops' ? 'basic' : 'custom',
```

**–í–ª–∏—è–Ω–∏–µ:**

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Basic
- Dress –∏ All –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è
- Outfit —Å–æ–∑–¥–∞–Ω–Ω—ã–π –Ω–∞ Dress ‚Üí –æ—Ç–∫—Ä–æ–µ—Ç—Å—è Custom ‚ö†Ô∏è

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**

```typescript
// Check if matches preset tab
if (isBasic(customCategories)) activeTab = 'basic';
else if (isDress(customCategories)) activeTab = 'dress';
else if (isAll(customCategories)) activeTab = 'all';
else activeTab = 'custom';
```

---

## üìä SUMMARY –ü–†–û–ë–õ–ï–ú

| #   | –ü—Ä–æ–±–ª–µ–º–∞                                            | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å    | –§–∞–π–ª           | –°—Ç—Ä–æ–∫–∞   |
| --- | --------------------------------------------------- | -------------- | -------------- | -------- |
| 1   | –ù–∞—á–∞–ª—å–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ 'basic' –≤–º–µ—Å—Ç–æ 'custom'           | üü° –°—Ä–µ–¥–Ω—è—è     | outfitStore.ts | 123      |
| 2   | selectedItemsForCreation –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è        | üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø | outfitStore.ts | 355-357  |
| 3   | confirmItemSelection –∏—Å–ø–æ–ª—å–∑—É–µ—Ç customTabCategories | üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø | outfitStore.ts | 282      |
| 4   | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è customTabCategories –≤–º–µ—Å—Ç–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö     | üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø | outfitStore.ts | 288, 321 |
| 5   | –ù–µ–ø–æ–ª–Ω—ã–π smart tab detection                        | üü† –°–µ—Ä—å–µ–∑–Ω–∞—è   | outfitStore.ts | 194      |

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ô WORKFLOW (–¢–†–ï–ë–£–ï–ú–´–ô)

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ outfit:

```
1. User: –ù–∞–∂–∏–º–∞–µ—Ç "Create Outfit"
2. System:
   - activeTab = 'custom'
   - customTabCategories = ['tops', 'bottoms', 'footwear'] (–∫–∞–∫ Basic)
   - selectedItemsForCreation = [null, null, null]
3. User: –í–∏–¥–∏—Ç Custom –≤–∫–ª–∞–¥–∫—É —Å 3 –∫–∞—Ä—É—Å–µ–ª—è–º–∏ (tops, bottoms, footwear)
```

### –°–º–µ–Ω–∞ –≤–∫–ª–∞–¥–∫–∏:

```
1. User: –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è —Å Basic –Ω–∞ Dress
2. System:
   - activeTab = 'dress'
   - –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å selectedItemsForCreation –ø–æ–¥ –Ω–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä
   - –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä—ã –≥–¥–µ category —Å–æ–≤–ø–∞–¥–∞–µ—Ç

–ü—Ä–∏–º–µ—Ä:
  Basic: ['tops', 'bottoms', 'footwear'] ‚Üí [shirt, jeans, sneakers]
  Dress: ['fullbody', 'footwear', 'accessories'] ‚Üí [null, sneakers, null]
                                                         ‚Üë —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ footwear
```

### –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Step 2:

```
1. User: –ù–∞–∂–∏–º–∞–µ—Ç "–î–∞–ª–µ–µ" –Ω–∞ –≤–∫–ª–∞–¥–∫–µ Dress
2. System:
   - –ë–µ—Ä–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏: ['fullbody', 'footwear', 'accessories']
   - –ë–µ—Ä–µ—Ç –≤—ã–±–æ—Ä—ã –∏–∑ selectedItemsForCreation: [dress, heels, bag]
   - –°–æ–∑–¥–∞–µ—Ç outfitItems —Ç–æ–ª—å–∫–æ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –≤–µ—â–µ–π –Ω–∞ Dress
   - –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ Step 2 —Å —ç—Ç–∏–º–∏ –≤–µ—â–∞–º–∏
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:

```
1. User: –ù–∞–∂–∏–º–∞–µ—Ç "Save"
2. System:
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ canvasSettings:
     - customTabCategories = ['fullbody', 'footwear', 'accessories'] (—Ç–µ —á—Ç–æ –±—ã–ª–∏ –Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ)
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç currentItems (–º–æ–≥—É—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã –Ω–∞ Step 2)
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ë–î
```

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```
1. User: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç outfit –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
2. System:
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç outfit –∏–∑ –ë–î
   - –ß–∏—Ç–∞–µ—Ç canvasSettings.customTabCategories = ['fullbody', 'footwear', 'accessories']
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —á—Ç–æ —ç—Ç–æ Dress ‚Üí activeTab = 'dress'
   - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç selectedItemsForCreation –∏–∑ outfit.items
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –≤–∫–ª–∞–¥–∫—É Dress —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –≤–µ—â–∞–º–∏
3. User: –í–∏–¥–∏—Ç –≤–∫–ª–∞–¥–∫—É Dress —Å —Ç–µ–º–∏ –∂–µ 3 –∫–∞—Ä—É—Å–µ–ª—è–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –≤–µ—â–∞–º–∏
```

---

## üéØ –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### Phase 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å initial activeTab –Ω–∞ 'custom'
2. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é selectedItemsForCreation –ø—Ä–∏ —Å–º–µ–Ω–µ –≤–∫–ª–∞–¥–∫–∏
3. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å confirmItemSelection –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
4. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏, –∞ –Ω–µ customTabCategories

### Phase 2: –£–ª—É—á—à–µ–Ω–∏—è

5. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π smart tab detection (Basic, Dress, All, Custom)
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å helper —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –≤–∫–ª–∞–¥–∫–∏
7. ‚úÖ –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### Phase 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

8. ‚úÖ Test Case 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ Custom
9. ‚úÖ Test Case 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ Basic
10. ‚úÖ Test Case 3: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ Dress
11. ‚úÖ Test Case 4: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ All
12. ‚úÖ Test Case 5: –°–º–µ–Ω–∞ –≤–∫–ª–∞–¥–æ–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤—ã–±–æ—Ä–æ–≤
13. ‚úÖ Test Case 6: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì

–ü—Ä–∏—Å—Ç—É–ø–∞—é –∫ Phase 1 - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

**ETA:** ~30 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫–∏:** –°—Ä–µ–¥–Ω–∏–µ (–∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ core logic)  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
