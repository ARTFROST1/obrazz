#!/usr/bin/env bash
# bin/render-build - Build script for Render deployment
# This script should be set as the Build Command in Render dashboard

set -e

echo "==> Installing dependencies..."
bundle install

echo "==> Precompiling assets..."
bundle exec rails assets:precompile

echo "==> Running primary database migrations..."
bundle exec rails db:migrate

echo "==> Running cache database migrations..."
bundle exec rails db:migrate:cache || echo "Cache migrations skipped (may already exist)"

echo "==> Running queue database migrations..."
bundle exec rails db:migrate:queue || echo "Queue migrations skipped (may already exist)"

echo "==> Running cable database migrations..."
bundle exec rails db:migrate:cable || echo "Cable migrations skipped (may already exist)"

echo "==> Build complete!"
